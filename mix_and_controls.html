<!-- 6.1.1 -->
<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0" />

    <title>WaveHit REAPER Mix and Controls</title>
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,700" rel="stylesheet" type="text/css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script src="main.js"></script>
    <script src="common_func.js"></script>

    <style type="text/css">
        body {
            background-color: #333333;
            color: #A9ABAB;
            font-family: 'Open Sans', sans-serif;
            font-size: 1em;
            text-align: center;
            margin: 0px;
            user-select: none;
            cursor: default;
        }

        iframe {
            border: none;
            width: 100%;
            height: 100%;
        }

        #markerSelect {
            width: 100%;
            color: #A9ABAB;
            background-color: #262626;
            border: none;
            font-size: 6svi;
            padding: 3%;
            -webkit-border-radius: 20px;
            -moz-border-radius: 20px;
            border-radius: 20px;
            -webkit-appearance: none;
        }

        select option:first-child {
            color: #555555;
            font-style: italic;
        }

        .button:hover .mouseover {
            visibility: visible;
        }

        .button:active .mouseover {
            visibility: hidden;
            pointer-events: all;
        }

        .button:active .shadow {
            visibility: hidden;
        }

        .button:active .gloss {
            visibility: hidden;
        }

        .button:active .active {
            visibility: visible;
        }

        label {
            font-size: 5svi;
            color: black;
            padding: 3%;
        }
        
        input[type="checkbox"] {
            height:8svi;
            width:8svi;
            cursor:pointer;
            position: relative;
            vertical-align: middle;
        }
    </style>

    <script type="text/javascript">
        const cmd_pre_roll_play = "41818";
        const cmd_pre_roll_rec = "41819";
        const region_name_idx = 1;
        const region_id_idx = 2;
        const region_start_pos_idx = 3;
        const region_end_pos_idx = 4;
        const region_color_idx = 5;
        const marker_name_idx = 1;
        const marker_id_idx = 2;
        const marker_pos_idx = 3;
        const marker_color_idx = 4;

        wwr_req_recur("TRACK;BEATPOS;TRANSPORT", 10);
        wwr_req_recur("MARKER;REGION", 500);
        wwr_req_recur("GET/" + cmd_pre_roll_play, 500);
        wwr_req_recur("GET/" + cmd_pre_roll_rec, 500);
        wwr_start();

        var nTrack = 0, nTrackOld = 0,
            pos_sec = 0.0, pos_sec_prev = 0.0, pos_beat = 0, pos_beat_prev = 0, currMarker = -1, selectMarkerOld = -1,

            last_transport_state = -1, drawnSig = 0, drawnBeat = 0, playPosSeconds = 0, newPos = -1, recarmCount = 0, last_time_str = "",
            statusPosition = [], statusPositionAr = [], recarmCountAr = [];

        function lumaOffset(c) {
            var c = c.substring(1);
            var rgb = parseInt(c, 16);
            var r = (rgb >> 16) & 0xff;
            var g = (rgb >> 8) & 0xff;
            var b = (rgb >> 0) & 0xff;
            var luma = 0.2126 * r + 0.7152 * g + 0.0722 * b;
            function componentToHex(c) {
                var hex = c.toString(16);
                return hex.length == 1 ? "0" + hex : hex;
            }
            if (luma < 150) { r = r + 150; g = g + 150; b = b + 150 }
            if (luma > 150) { r = r - 120; g = g - 120; b = b - 120 }
            if (r < 0) { r = 0 }; if (g < 0) { g = 0 }; if (b < 0) { b = 0 }
            if (r > 255) { r = 255 }; if (g > 255) { g = 255 }; if (b > 255) { b = 255 }
            return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
        }

        function easeInOutCubic(t, b, c, d) {
            if ((t /= d / 2) < 1) {
                return c / 2 * t * t * t + b;
            }
            else { return c / 2 * ((t -= 2) * t * t + 2) + b; }
        };

        function elAttribute(id, attribute, value) {
            if (document.getElementById(id)) {
                document.getElementById(id).setAttributeNS(null, attribute, value);
            }
        }

        function toColor(num) {
            num >>>= 0;
            var b = num & 0xFF,
                g = (num & 0xFF00) >>> 8,
                r = (num & 0xFF0000) >>> 16,
                a = (num & 0xF000000) >>> 24;
            return a == 0 ? "" : "rgba(" + [r, g, b, a].join(",") + ")";
        }

        function currBPM() {
            return Math.round((pos_beat - pos_beat_prev) / (pos_sec - pos_sec_prev) * 60);
        }

        function on_record_button(e) {
            if (recarmCount > 0 || confirm("no tracks are armed, start record?")) wwr_req(1013);
            return false;
        }

        function prompt_abort() {
            if (!(last_transport_state & 4)) {
                wwr_req(1016);
            } else {
                if (confirm("abort recording? contents will be lost!")) wwr_req(40668);
            }
        }

        function prompt_seek() {
            if (!(last_transport_state & 4)) {
                var seekto = prompt("Seek to position:", last_time_str);
                if (seekto != null) {
                    wwr_req("SET/POS_STR/" + encodeURIComponent(seekto));
                }
            }
        }

        function wwr_onreply(results) {
            var resultsDisplay = document.getElementById("_results");
            if (resultsDisplay != null) {
                resultsDisplay.innerHTML = results;
            }

            var ar = results.split("\n");
            for (var x = 0; x < ar.length; x++) {
                var tok = ar[x].split("\t");
                if (tok.length > 0) switch (tok[0]) {
                    case "TRACK": // TRACK \t tracknumber \t trackname \t trackflags \t volume \t pan \t last_meter_peak \t last_meter_pos \t width/pan2 \t panmode \t sendcnt \t recvcnt \t hwoutcnt \t color
                        idx = parseInt(tok[1]);

                        if (tok[3] & 64) { recarmCountAr[idx] = 1 } else { recarmCountAr[idx] = 0 }
                        function getSum(total, num) { return total + num; }
                        var armedCount = document.getElementById("armed_count");
                        var armedText = document.getElementById("armed_text");
                        recarmCount = recarmCountAr.reduce(getSum);
                        armedCount.textContent = recarmCount;
                        armedCount.setAttributeNS(null, "fill", ((recarmCount == 0) ? "#5D3729" : "#545454"));
                        armedText.setAttributeNS(null, "fill", ((recarmCount == 0) ? "#5D3729" : "#545454"));
                        break;

                    case "BEATPOS":
                        pos_sec_prev = pos_sec;
                        pos_beat_prev = pos_beat;
                        pos_sec = tok[2];
                        pos_beat = tok[3];

                        var playLine = document.querySelector('#playLine');
                        if (tok.length > 5 && playLine) {
                            var playLineCirc = 301.1;
                            var playLineArc = playLineCirc - (playLineCirc / tok[6]);
                            //var playLineRotate = (360 / tok[6]) * tok[5]; //freewheeling play line
                            thisBeat = Math.round(tok[5]);
                            var playLineRotate = (360 / tok[6]) * thisBeat;
                            thisSig = tok[6];
                            if (drawnSig != thisSig || drawnBeat != thisBeat && playLine) {
                                playLine.setAttributeNS(null, "stroke-dasharray", playLineCirc);
                                playLine.setAttributeNS(null, "stroke-dashoffset", playLineArc);
                                playLine.setAttribute("transform", "rotate(" + playLineRotate + ",151.8,52.4)");
                            }
                        }

                        break;

                    case "MARKER": // MARKER \t name \t ID \t position [\t color]
                        g_markers.push(tok);
                        break;

                    case "MARKER_LIST":
                        g_markers = [];
                        break;

                    case "TRANSPORT": // TRANSPORT \t playstate \t position_seconds \t isRepeatOn \t position_string \t position_string_beats
                        if (tok.length > 4) {
                            var backLoaded = document.getElementById("backLoad");
                            if (backLoaded != null) {
                                if (tok[1] != last_transport_state) {
                                    last_transport_state = tok[1];
                                    document.getElementById("playButtonOff").style.visibility = (last_transport_state & 1) ? "hidden" : "visible";
                                    document.getElementById("playButtonOn").style.visibility = (last_transport_state & 1) ? "visible" : "hidden";
                                    document.getElementById("pauseButtonOff").style.visibility = (last_transport_state & 2) ? "hidden" : "visible";
                                    document.getElementById("pauseButtonOn").style.visibility = (last_transport_state & 2) ? "visible" : "hidden";
                                    document.getElementById("record_off").style.visibility = (last_transport_state & 4) ? "hidden" : "";
                                    document.getElementById("record_on").style.visibility = (last_transport_state & 4) ? "visible" : "";
                                    document.getElementById("armed_text").style.visibility = (last_transport_state & 4) ? "hidden" : "";
                                    document.getElementById("armed_count").style.visibility = (last_transport_state & 4) ? "hidden" : "";
                                    document.getElementById("abort_text").style.visibility = (last_transport_state & 4) ? "visible" : "";
                                    document.getElementById("abort_cross").style.visibility = (last_transport_state & 4) ? "visible" : "";
                                }
                                var statusDisplay = document.getElementById("status");

                                //make an array of the current position and its unit
                                statusPosition[0] = tok[4];
                                statusPositionAr = tok[4].split(".");
                                if (statusPositionAr[1] == undefined) {
                                    if (statusPositionAr[0].match(":")) { statusPosition[1] = "Hours:Minutes:Seconds:Frames"; }
                                    else { statusPosition[1] = "samples / frames"; }
                                }
                                else {
                                    if (statusPositionAr[1].length == 3) {
                                        if (statusPositionAr[0].match(":")) { statusPosition[1] = "Minutes:Seconds"; }
                                        else { statusPosition[1] = "Seconds"; }
                                    }
                                    else { statusPosition[1] = "Measures.Beats"; }
                                }
                                document.getElementById("timeUnits").textContent = statusPosition[1];
                                statusDisplay.textContent = statusPosition[0];
                                statusDisplay.style.fill = "#a8a8a8";

                                if (tok[2] != playPosSeconds) { playPosSeconds = tok[2]; }
                            }
                            else {
                                last_time_str = tok[4];
                            }
                        }
                        break;

                    case "REGION_LIST":
                        g_regions = [];
                        break;
                    case "REGION": // REGION \t name \t ID \t start-position \t end-position [\t color]
                        g_regions.push(tok);
                        break;
                    case "MARKER_LIST_END":
                        var pos = parseFloat(playPosSeconds);
                        break;

                    case "REGION_LIST_END":

                        //assemble mrMap array : time, marker number, region start number, region end number.
                        for (var i = 0; i < g_regions.length; i++) {
                            if (g_regions[i][5] == 0) { g_regions[i][5] = 25198720; } // Give uncoloured regions a colour.
                        }
                        for (var i = 0; i < g_markers.length; i++) {
                            if (g_markers[i][4] == 0) { g_markers[i][4] = 25198720; } // Give uncoloured markers a colour.
                        }
                        var mrMapAr = [];
                        for (var i = 0; i < g_regions.length * 2; i++) {
                            mrMapAr[i] = [];
                            if (i < g_regions.length) {                             //add the region starts to the ar
                                mrMapAr[i][0] = g_regions[i][3];
                                mrMapAr[i][2] = g_regions[i][2];
                            }
                            else {                                               //add the region ends to the ar
                                mrMapAr[i][0] = g_regions[i - g_regions.length][4];
                                mrMapAr[i][3] = g_regions[i - g_regions.length][2];
                            }
                        }
                        for (var i = 0; i < g_markers.length; i++) {                //add the markers to the ar
                            mrMapAr[i + (g_regions.length * 2)] = [];
                            mrMapAr[i + (g_regions.length * 2)][0] = g_markers[i][3];
                            mrMapAr[i + (g_regions.length * 2)][1] = g_markers[i][2];
                        }

                        for (var i = 0; i < mrMapAr.length; i++) {                  //prep times for sorting
                            posToSix = parseFloat(mrMapAr[i][0]).toFixed(6);
                            mrMapAr[i][0] = parseFloat(posToSix);
                        }

                        mrMapAr.sort(function (a, b) {                           //sort into time order
                            return (a[0] === b[0] ? 0 : (a[0] < b[0] ? -1 : 1));
                        });

                        function mergeAt(idx) {
                            if (mrMapAr[i - 1][idx]) { a = mrMapAr[i - 1][idx] } else { a = 0 };
                            if (mrMapAr[i][idx]) { b = mrMapAr[i][idx] } else { b = 0 };
                            mrMapAr[i - 1][idx] = parseFloat(a) + parseFloat(b);
                        }

                        var mergeDone = 0;
                        for (var i = 1; i < mrMapAr.length; i++) {                  //merge cells if at same time, delete the duplicate
                            if (mrMapAr[i - 1] && mrMapAr[i][0] === mrMapAr[i - 1][0]) {
                                mergeAt(1); mergeAt(2); mergeAt(3);
                                mrMapAr.splice(i, 1);
                            }
                            if (i == (mrMapAr.length - 1)) { mergeDone = 1 }
                        }

                        var prevl = -1, thisl = -1, nextl = -1;
                        var curr_region = -1;
                        if (mergeDone == 1) {
                            for (var i = 0; i < mrMapAr.length; i++) {
                                var diff = (mrMapAr[i][0] - pos);
                                if (diff < 0) {
                                    if (i > prevl) { prevl = i }
                                }
                                if (diff == 0) { thisl = i };
                                if (diff > 0) {
                                    if (i > nextl) { nextl = i; break; }
                                }
                            }

                            for (i = 0; i < g_regions.length; ++i)
                            {
                                if (pos > g_regions[i][region_start_pos_idx] && pos < g_regions[i][region_end_pos_idx])
                                {
                                    curr_region = i;
                                    break;
                                }
                            }
                        }

                        function getValuesFromId(array, id, colourIdx) {
                            for (var i = 0, len = array.length; i < len; i++) {
                                if (array[i][2] == id) { return [id, (array[i][1]), (array[i][colourIdx])] }
                            }
                            return [0, 0, 0];
                        }

                        var nextPrevSvg = document.getElementById("nextPrev")
                        if ((pos != newPos || mrMapAr.length != newMrMapLength) && mergeDone == 1 && nextPrevSvg) {
                            var rIdxAsg = [];
                            search: for (i = 0; i < 4; i++) {                         // 4 is the maximum drawable number of regions
                                if (mrMapAr[prevl] && mrMapAr[prevl][3] >= 1) {               //region end at prev?
                                    var q = parseFloat(mrMapAr[prevl][3]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; continue search; }
                                }
                                if (mrMapAr[prevl] && mrMapAr[prevl][2] >= 1) {               //region start at prev?
                                    var q = parseFloat(mrMapAr[prevl][2]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; continue search; }
                                }
                                if (mrMapAr[thisl] && mrMapAr[thisl][3] >= 1) {               //region end at this?
                                    var q = parseFloat(mrMapAr[thisl][3]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; continue search; }
                                }
                                if (mrMapAr[thisl] && mrMapAr[thisl][2] >= 1) {               //region start at this?
                                    var q = parseFloat(mrMapAr[thisl][2]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; continue search; }
                                }
                                if (mrMapAr[nextl] && mrMapAr[nextl][3] >= 1) {               //region end at next?
                                    var q = parseFloat(mrMapAr[nextl][3]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; continue search }
                                }
                                if (mrMapAr[nextl] && mrMapAr[nextl][2] >= 1) {               //region start at next?
                                    var q = parseFloat(mrMapAr[nextl][2]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; }
                                }
                            }

                            function getValFromAr(array, id, idLoc, valLoc) {
                                for (var i = 0, len = array.length; i < len; i++) {
                                    if (array[i][idLoc] == id) { return array[i][valLoc]; }
                                }
                                return;
                            }

                            for (i = 1; i < 5; i++) {
                                this['r' + i + 'StalkLx'] = 45.6;
                                this['r' + i + 'StalkRx'] = 273.1;
                                if (rIdxAsg[i - 1] && rIdxAsg[i - 1] >= 0) {
                                    this['r' + i + 'Idx'] = rIdxAsg[i - 1];
                                    this['r' + i + 'Name'] = getValFromAr(g_regions, rIdxAsg[i - 1], 2, 1);
                                    this['col' + i] = getValFromAr(g_regions, rIdxAsg[i - 1], 2, 5);
                                    this['rCol' + i] = "#" + (this['col' + i] | 0x1000000).toString(16).substr(-6);
                                    if (prevl >= 0 && mrMapAr[prevl][3] == rIdxAsg[i - 1]) { this['r' + i + 'StalkRx'] = 102.5; }
                                    if (prevl >= 0 && mrMapAr[prevl][2] == rIdxAsg[i - 1]) { this['r' + i + 'StalkLx'] = 102.5; }
                                    if (thisl >= 0 && mrMapAr[thisl][2] == rIdxAsg[i - 1]) { this['r' + i + 'StalkLx'] = 159.4; }
                                    if (thisl >= 0 && mrMapAr[thisl][3] == rIdxAsg[i - 1]) { this['r' + i + 'StalkRx'] = 159.4; }
                                    if (nextl >= 0 && mrMapAr[nextl][2] == rIdxAsg[i - 1]) { this['r' + i + 'StalkLx'] = 216.2; }
                                    if (nextl >= 0 && mrMapAr[nextl][3] == rIdxAsg[i - 1]) { this['r' + i + 'StalkRx'] = 216.2; }
                                    document.getElementById('region' + i).setAttributeNS(null, "visibility", "visible");
                                    document.getElementById('r' + i + 'Rect').setAttributeNS(null, "fill", this['rCol' + i]);
                                    document.getElementById('r' + i + 'StalkL').setAttributeNS(null, "x1", this['r' + i + 'StalkLx']);
                                    document.getElementById('r' + i + 'StalkL').setAttributeNS(null, "x2", this['r' + i + 'StalkLx']);
                                    document.getElementById('r' + i + 'StalkR').setAttributeNS(null, "x1", this['r' + i + 'StalkRx']);
                                    document.getElementById('r' + i + 'StalkR').setAttributeNS(null, "x2", this['r' + i + 'StalkRx']);
                                    this['r' + i + 'RectW'] = (this['r' + i + 'StalkRx']) - (this['r' + i + 'StalkLx']);
                                    document.getElementById('r' + i + 'Rect').setAttributeNS(null, "x", this['r' + i + 'StalkLx']);
                                    document.getElementById('r' + i + 'Rect').setAttributeNS(null, "width", this['r' + i + 'RectW']);
                                    if (!this['r' + i + 'Name']) { this['r' + i + 'Name'] = this['r' + i + 'Idx'] }
                                    document.getElementById('r' + i + 'Name').textContent = this['r' + i + 'Name'];
                                    document.getElementById('r' + i + 'Name').setAttributeNS(null, "fill", lumaOffset(this['rCol' + i]));

                                    // trim
                                    var name_el = document.getElementById('r' + i + 'Name');
                                    var rect_el = document.getElementById('r' + i + 'Rect');
                                    if (name_el.textLength.baseVal.value > rect_el.width.baseVal.value)
                                    {
                                        var ratio = rect_el.width.baseVal.value / name_el.textLength.baseVal.value;
                                        var curr_str = name_el.textContent;
                                        name_el.textContent = curr_str.slice(0, curr_str.length * ratio - 1) + '…';
                                    }

                                    this['r' + i + 'NamePos'] = this['r' + i + 'StalkLx'] + ((this['r' + i + 'StalkRx'] - this['r' + i + 'StalkLx']) / 2);
                                    document.getElementById('r' + i + 'Name').setAttributeNS(null, "transform", "matrix(1 0 0 1 " + this['r' + i + 'NamePos'] + " 31)");
                                }
                                else { document.getElementById('region' + i).setAttributeNS(null, "visibility", "hidden"); }
                            }

                            var elem_reg_current = document.getElementById('region_current');
                            var show_current = false;
                            if (curr_region != -1)
                            {
                                var already_exist = false;
                                for (i = 0; i < rIdxAsg.length; ++i)
                                {
                                    if (rIdxAsg[i] == Number(g_regions[curr_region][region_id_idx]))
                                    {
                                        already_exist = true;
                                        break;
                                    }
                                }

                                if (!already_exist)
                                    show_current = true;
                            }

                            if (show_current)
                            {
                                elem_reg_current.setAttributeNS(null, "visibility", "visible");
                                var col = g_regions[curr_region][region_color_idx];
                                var rCol = "#" + (col | 0x1000000).toString(16).substr(-6);
                                elem_reg_current.setAttributeNS(null, "fill", rCol);
                                var elem_name = document.getElementById('rcName');
                                elem_name.textContent = g_regions[curr_region][region_name_idx];
                                elem_name.setAttributeNS(null, "fill", lumaOffset(rCol));

                                this['rcNamePos'] = 45.6 + ((273.1 - 45.6) / 2);
                                document.getElementById('rcName').setAttributeNS(null, "transform", "matrix(1 0 0 1 " + this['rcNamePos'] + " 31)");
                            }
                            else
                            {
                                elem_reg_current.setAttributeNS(null, "visibility", "hidden");
                            }

                            if (mrMapAr[prevl] && mrMapAr[prevl][1] >= 1) {
                                var mPrevIdx = mrMapAr[prevl][1];
                                var mPrevName = getValFromAr(g_markers, mPrevIdx, 2, 1);
                                var mPrevCol = getValFromAr(g_markers, mPrevIdx, 2, 4);
                                mPrevCol = "#" + (mPrevCol | 0x1000000).toString(16).substr(-6);
                                document.getElementById("marker1").setAttributeNS(null, "visibility", "visible");
                                document.getElementById("marker1Bg").setAttributeNS(null, "fill", mPrevCol);
                                document.getElementById("marker1Number").textContent = mPrevIdx;
                                document.getElementById("marker1Number").setAttributeNS(null, "fill", lumaOffset(mPrevCol));
                                document.getElementById("prevMarkerName").textContent = (!mPrevName) ? ("unnamed") : (mPrevName);

                                // trim
                                var name_el = document.getElementById("prevMarkerName");
                                var rect_el = document.getElementById("npClip1");
                                if (name_el.textLength.baseVal.value > rect_el.width.baseVal.value)
                                {
                                    var ratio = rect_el.width.baseVal.value / name_el.textLength.baseVal.value;
                                    var curr_str = name_el.textContent;
                                    name_el.textContent = curr_str.slice(0, curr_str.length * ratio - 1) + '…';
                                }
                            }
                            else { document.getElementById("marker1").setAttributeNS(null, "visibility", "hidden"); }

                            if (mrMapAr[thisl] && mrMapAr[thisl][1] >= 1) {
                                var mThisIdx = mrMapAr[thisl][1];
                                var mThisName = getValFromAr(g_markers, mThisIdx, 2, 1);
                                var mThisCol = getValFromAr(g_markers, mThisIdx, 2, 4);
                                mThisCol = "#" + (mThisCol | 0x1000000).toString(16).substr(-6);
                                document.getElementById("marker2").setAttributeNS(null, "visibility", "visible");
                                document.getElementById("marker2Bg").setAttributeNS(null, "fill", mThisCol);
                                document.getElementById("marker2Number").textContent = mThisIdx;
                                document.getElementById("marker2Number").setAttributeNS(null, "fill", lumaOffset(mThisCol));
                                document.getElementById("atMarkerName").textContent = (!mThisName) ? ("unnamed") : (mThisName);

                                // trim
                                var name_el = document.getElementById("atMarkerName");
                                var rect_el = document.getElementById("npClip3");
                                if (name_el.textLength.baseVal.value > rect_el.width.baseVal.value)
                                {
                                    var ratio = rect_el.width.baseVal.value / name_el.textLength.baseVal.value;
                                    var curr_str = name_el.textContent;
                                    name_el.textContent = curr_str.slice(0, curr_str.length * ratio - 1) + '…';
                                }
                            }
                            else { document.getElementById("marker2").setAttributeNS(null, "visibility", "hidden"); }

                            if (mrMapAr[nextl] && mrMapAr[nextl][1] >= 1) {
                                var mNextIdx = mrMapAr[nextl][1];
                                var mNextName = getValFromAr(g_markers, mNextIdx, 2, 1);
                                var mNextCol = getValFromAr(g_markers, mNextIdx, 2, 4);
                                mNextCol = "#" + (mNextCol | 0x1000000).toString(16).substr(-6);
                                document.getElementById("marker3").setAttributeNS(null, "visibility", "visible");
                                document.getElementById("marker3Bg").setAttributeNS(null, "fill", mNextCol);
                                document.getElementById("marker3Number").textContent = mNextIdx;
                                document.getElementById("marker3Number").setAttributeNS(null, "fill", lumaOffset(mNextCol));
                                document.getElementById("nextMarkerName").textContent = (!mNextName) ? ("unnamed") : (mNextName);

                                // trim
                                var name_el = document.getElementById("nextMarkerName");
                                var rect_el = document.getElementById("npClip5");
                                if (name_el.textLength.baseVal.value > rect_el.width.baseVal.value)
                                {
                                    var ratio = rect_el.width.baseVal.value / name_el.textLength.baseVal.value;
                                    var curr_str = name_el.textContent;
                                    name_el.textContent = curr_str.slice(0, curr_str.length * ratio - 1) + '…';
                                }
                            }
                            else { document.getElementById("marker3").setAttributeNS(null, "visibility", "hidden"); }

                            if (prevl >= 0) { homeIconVis = "hidden"; prevIconVis = "visible"; }
                            else {
                                homeIconVis = "visible"; prevIconVis = "hidden";
                                if (pos > 0) {
                                    document.getElementById("marker1").setAttributeNS(null, "visibility", "visible");
                                    document.getElementById("prevMarkerName").textContent = "HOME";
                                    document.getElementById("marker1Number").textContent = "H";
                                    document.getElementById("marker1Bg").setAttributeNS(null, "fill", "#1a1a1a");
                                    document.getElementById("marker1Number").setAttributeNS(null, "fill", "#A8A8A8");
                                }
                                else {
                                    document.getElementById("marker2").setAttributeNS(null, "visibility", "visible");
                                    document.getElementById("atMarkerName").textContent = "HOME";
                                    document.getElementById("marker2Number").textContent = "H";
                                    document.getElementById("marker2Bg").setAttributeNS(null, "fill", "#1a1a1a");
                                    document.getElementById("marker2Number").setAttributeNS(null, "fill", "#A8A8A8");
                                }
                            }
                            if (thisl < 0 && pos != 0) { elAttribute("dropMarker", "visibility", "visible") }
                            else { elAttribute("dropMarker", "visibility", "hidden") }
                            if (nextl >= 0) {
                                endIconVis = "hidden"; nextIconVis = "visible";
                            }
                            else {
                                document.getElementById("marker3").setAttributeNS(null, "visibility", "visible");
                                document.getElementById("nextMarkerName").textContent = "END";
                                document.getElementById("marker3Number").textContent = "E";
                                document.getElementById("marker3Bg").setAttributeNS(null, "fill", "#1a1a1a");
                                document.getElementById("marker3Number").setAttributeNS(null, "fill", "#A8A8A8");
                                endIconVis = "visible"; nextIconVis = "hidden";
                            }
                            elAttribute("iconPrev", "visibility", prevIconVis);
                            elAttribute("iconHome", "visibility", homeIconVis);
                            elAttribute("iconNext", "visibility", nextIconVis);
                            elAttribute("iconEnd", "visibility", endIconVis);

                            newPos = pos;
                            newMrMapLength = mrMapAr.length;
                        }
                        break;
                    case "CMDSTATE": // CMDSTATE \t command_id \t state
                        if (tok.length == 3)
                        {
                            if (tok[1] == cmd_pre_roll_play)
                                var elem = document.getElementById("pre_roll_play_box");
                            else if (tok[1] == cmd_pre_roll_rec)
                                var elem = document.getElementById("pre_roll_rec_box");

                            if (elem)
                            {
                                var enabled = false;
                                if (tok[2] > 0)
                                    enabled = true;

                                var new_val = enabled ? "☑️" : "⬜";
                                if (elem.textContent != new_val)
                                {
                                    elem.textContent = new_val;
                                    push_el(elem, false);
                                }
                            }
                        }
                        break;
                }
            }

            var markerSelect = document.getElementById("markerSelect");
            var statusBPMDisplay = document.getElementById("bpm_status");

            var bpm = currBPM();
            statusBPMDisplay.textContent = bpm ? bpm : '-';
            statusBPMDisplay.style.fill = "#a8a8a8";

            //----------------------------------
            // Now do things based on what's been DRAWN
            //----------------------------------

            // enable and fill the marker selector
            markerSelect.hidden = false;
            if (markerSelect.options.length == 1)
            {
                const options_start_pos_idx = 0;
                const options_end_pos_idx = 1;
                const options_data_idx = 2;
                const options_is_marker_idx = 3;
                var options = [];

                function compareOptions(a, b)
                {
                    return a[options_start_pos_idx] - b[options_start_pos_idx];
                }

                for (i = 0; i < g_regions.length; i++)
                {
                    var option = document.createElement("option");
                    [tag, name, id, start_pos, end_pos, color] = g_regions[i];
                    option.text = 'R' + id + ". " + name;
                    option.style.color = color == '' ? "#A9ABAB" : ("#" + (color | 0x1000000).toString(16).substr(-6));
                    option.id = 'r' + id;
                    options.push([start_pos, end_pos, option, false]);
                }

                for (x = 0; x < g_markers.length; x++) {
                    var option = document.createElement("option");
                    [tag, name, id, position, color_num] = g_markers[x];
                    option.text = 'M' + id + ". " + name;
                    var color = toColor(color_num);
                    option.style.color = color == '' ? "#A9ABAB" : color;
                    option.id = 'm' + id;
                    options.push([position, position, option, true]);
                }

                options.sort(compareOptions);

                var current_region = -1;
                for (i = 0; i < options.length; i++)
                {
                    if (current_region != -1)
                    {
                        if (Number(options[i][options_start_pos_idx]) > Number(options[current_region][options_end_pos_idx]))
                            current_region = -1;
                    }

                    if (!options[i][options_is_marker_idx]) // region
                    {
                        if (current_region == -1)
                            current_region = i;
                    }
                    else // marker
                    {
                        if (current_region != -1)
                            options[i][options_data_idx].text = "⨽ " + options[i][options_data_idx].text;
                    }
                    markerSelect.add(options[i][options_data_idx]);
                }
            }

            if (markerSelect.options.length > 1) {
                var found = false;
                var new_marker = -1;
                var select_marker = 'm';
                var curr_pos = parseFloat(pos_sec) + 0.0001;
                var marker_dist = -1;

                for (i = g_markers.length - 1; i >= 0; --i) {
                    [tag, name, id, position, color] = g_markers[i];
                    const marker = g_markers[i];
                    const pos_float = parseFloat(marker[marker_pos_idx]);
                    if (pos_float < curr_pos) {
                        marker_dist = curr_pos - pos_float;
                        new_marker = marker[marker_id_idx];
                        found = true;
                        break;
                    }
                }

                var new_region = -1;
                var region_dist = -1;
                for (i = g_regions.length - 1; i >= 0; --i)
                {
                    if (parseFloat(g_regions[i][region_start_pos_idx]) < curr_pos)
                    {
                        region_dist = curr_pos - parseFloat(g_regions[i][region_start_pos_idx]);
                        new_region = g_regions[i][region_id_idx];
                        found = true;
                        break;
                    }
                }

                if (found)
                {
                    if (region_dist < marker_dist || marker_dist == -1)
                    {
                        new_marker = new_region;
                        select_marker = 'r';
                    }
                    select_marker += new_marker;
                }
                else
                    select_marker = ''; // for HOME

                var users_changes = true;
                if (select_marker != currMarker) {
                    users_changes = false; // changes come from server
                    var selection_index = 0;

                    for (i = 0; i < markerSelect.options.length; ++i)
                    {
                        if (markerSelect.options[i].id == select_marker)
                        {
                            selection_index = markerSelect.options[i].index;
                            break;
                        }
                    }

                    markerSelect.selectedIndex = selection_index;
                    currMarker = markerSelect.children[markerSelect.selectedIndex].id;
                    var color = markerSelect.children[markerSelect.selectedIndex].style.color;
                    markerSelect.style.color = color == '' ? markerSelect.children[0].style.color : color;
                }

                // read the selection
                var selectChoice = markerSelect.selectedIndex;
                if (selectChoice != selectMarkerOld) {
                    selectMarkerOld = selectChoice;
                    if (users_changes)
                    {
                        if (selectChoice == 0)
                            wwr_req("SET/POS/0");
                        else
                            wwr_req("SET/POS_STR/" + markerSelect.children[selectChoice].id);

                        var color = markerSelect.children[selectChoice].style.color;
                        markerSelect.style.color = color == '' ? markerSelect.children[0].style.color : color;
                    }
                    currMarker = markerSelect[selectChoice].id;
                }
            }
        }

        function init() {
            if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
                for (let l = 0; l < document.styleSheets.length; l++) {
                    let ss = document.styleSheets[l];
                    if (ss.cssRules) for (let i = 0; i < ss.cssRules.length; i++) {
                        let st = ss.cssRules[i].selectorText;
                        if (st != undefined && st.startsWith(".button")) ss.removeRule(i--);
                    }
                }
            }
        }

        function enterBPM() {
            wwr_req("41821;41820");
            var curr_bpm = currBPM();
            var new_bpm = prompt("Enter new BPM", curr_bpm);
            if (new_bpm == null)
                return;

            var diff = Math.abs(new_bpm - curr_bpm);
            var tens = Math.floor(diff / 10);
            var ones = diff % 10;

            var comm_tens = new_bpm < curr_bpm ? "41136" : "41135";
            for (i = 0; i < tens; ++i) {
                wwr_req(comm_tens);
            }

            var comm_ones = new_bpm < curr_bpm ? "41130" : "41129";
            for (i = 0; i < ones; ++i) {
                wwr_req(comm_ones);
            }
        }

        function push_el(elem, is_down) {
            elem.style.fontSize = is_down ? "x-large" : "xx-large";
        }

        function insert_marker() {
            if (confirm('Insert a new marker at the current position?'))
                wwr_req(40157)
        }

        function create_iframe_listener(mix)
        {
            var iframe_body = mix.contentWindow.document.body;
            function update_height() { mix.style.height = iframe_body.scrollHeight + 'px'; }
            update_height();
            iframe_body.addEventListener("mix_done", (event) => {
                update_height();
            });
        }
    </script>
</head>

<body onLoad="init()">
    <iframe id="mix_frame" title="iframe" src="more_me_wh.html" onload="create_iframe_listener(this)"></iframe>

    <hr class="rounded">

    <!-- <div id="marker_name"></div> -->
    <select id="markerSelect">
        <option>HOME</option>
    </select><br>

    <div>
        <svg id="nextPrev" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px" y="0px" width="100%" height="100%" viewBox="0 0 318.9 87.8" xml:space="preserve">
            <polygon id="markerSecBg" fill="#262626" points="164.3,12.5 159,17.8 153.8,12.5 70.4,12.5 70.4,79.2 153.8,79.2 159,74 
        164.3,79.2 248.3,79.2 248.3,12.5 " />
            <rect id="markerStrip" x="70.4" y="50.4" fill="#2D2D2D" width="177.9" height="15" />
            <rect id="regionStrip" x="70.4" y="20.2" fill="#2D2D2D" width="177.9" height="15" />
            <path id="locTriangles" fill="#666666"
                d="M152.4,87.8l6.6-6.6l6.6,6.6H152.4z M152.4,4l6.6,6.6l6.6-6.6H152.4z" />
            <style type="text/css">
                .st0 {
                    fill: none;
                    stroke: #808080;
                    stroke-miterlimit: 10;
                }

                .st3 {
                    font-family: 'Open Sans';
                    text-anchor: middle;
                }

                .st4 {
                    font-size: 10px;
                }
            </style>
            <g id="region1" visibility="hidden">
                <line id="r1StalkL" class="st0" x1="45.6" y1="30.7" x2="45.6" y2="73.6" />
                <line id="r1StalkR" class="st0" x1="102.5" y1="30.7" x2="102.5" y2="73.6" />
                <rect id="r1Rect" x="45.6" y="20.2" rx="3" ry="3" stroke="#808080" width="56.9" height="15.1" />
                <text id="r1Name" transform="matrix(1 0 0 1 74.5 31)" class="st3 st4"></text>
            </g>
            <g id="region2" visibility="hidden">
                <line id="r2StalkL" class="st0" x1="45.6" y1="30.7" x2="45.6" y2="73.6" />
                <line id="r2StalkR" class="st0" x1="102.5" y1="30.7" x2="102.5" y2="73.6" />
                <rect id="r2Rect" x="45.6" y="20.2" rx="3" ry="3" stroke="#808080" width="56.9" height="15.1" />
                <text id="r2Name" transform="matrix(1 0 0 1 74.5 31)" class="st3 st4"></text>
            </g>
            <g id="region3" visibility="hidden">
                <line id="r3StalkL" class="st0" x1="45.6" y1="30.7" x2="45.6" y2="73.6" />
                <line id="r3StalkR" class="st0" x1="102.5" y1="30.7" x2="102.5" y2="73.6" />
                <rect id="r3Rect" x="45.6" y="20.2" rx="3" ry="3" stroke="#808080" width="56.9" height="15.1" />
                <text id="r3Name" transform="matrix(1 0 0 1 74.5 31)" class="st3 st4"></text>
            </g>
            <g id="region4" visibility="hidden">
                <line id="r4StalkL" class="st0" x1="45.6" y1="30.7" x2="45.6" y2="73.6" />
                <line id="r4StalkR" class="st0" x1="102.5" y1="30.7" x2="102.5" y2="73.6" />
                <rect id="r4Rect" x="45.6" y="20.2" rx="3" ry="3" stroke="#808080" width="56.9" height="15.1" />
                <text id="r4Name" transform="matrix(1 0 0 1 74.5 31)" class="st3 st4"></text>
            </g>
            <g id="region_current" visibility="hidden">
                <line id="rcStalkL" class="st0" x1="45.6" y1="30.7" x2="45.6" y2="73.6" />
                <line id="rcStalkR" class="st0" x1="273.1" y1="30.7" x2="273.1" y2="73.6" />
                <rect id="rcRect" x="45.6" y="20.2" rx="3" ry="3" stroke="#808080" width="227.5" height="15.1"/>
                <text id="rcName" transform="matrix(1 0 0 1 74.5 31)" class="st3 st4">test</text>
            </g>

            <g id="marker1" visibility="hidden">
                <line id="markerStalk" fill="none" stroke="#808080" stroke-miterlimit="10" x1="102.5" y1="59.7"
                    x2="102.5" y2="73.6" />
                <rect id="marker1Bg" x="95" y="50.4" rx="3" ry="3" stroke="#808080" stroke-miterlimit="10" width="15"
                    height="15" />
                <text id="marker1Number" transform="matrix(1 0 0 1 102.5 61.5)" fill="#A8A8A8" font-family="'Open Sans'"
                    text-anchor="middle" font-size="10px"></text>
                <g>
                    <defs>
                        <rect id="npClip1" x="74.1" y="35.8" width="56.8" height="14.6" />
                    </defs>
                    <clipPath id="npClip2">
                        <use xlink:href="#npClip1" overflow="visible" />
                    </clipPath>
                    <g clip-path="url(#npClip2)">
                        <text id="prevMarkerName" transform="matrix(1 0 0 1 102.5 46.6)" fill="#A8A8A8"
                            font-family="'Open Sans'" text-anchor="middle" font-size="10px"></text>
                    </g>
                </g>
            </g>
            <g id="marker2" visibility="hidden">
                <line id="markerStalk_1_" fill="none" stroke="#808080" stroke-miterlimit="10" x1="159.3" y1="59.7"
                    x2="159.3" y2="73.6" />
                <rect id="marker2Bg" x="151.8" y="50.4" rx="3" ry="3" stroke="#808080" stroke-miterlimit="10" width="15"
                    height="15" />
                <text id="marker2Number" transform="matrix(1 0 0 1 159.5 61.5)" fill="#A8A8A8" font-family="'Open Sans'"
                    text-anchor="middle" font-size="10px"></text>
                <g>
                    <defs>
                        <rect id="npClip3" x="130.9" y="35.8" width="56.8" height="14.6" />
                    </defs>
                    <clipPath id="npClip4">
                        <use xlink:href="#npClip3" overflow="visible" />
                    </clipPath>
                    <g clip-path="url(#npClip4)">
                        <text id="atMarkerName" transform="matrix(1 0 0 1 159.5 46.6)" fill="#A8A8A8"
                            font-family="'Open Sans'" text-anchor="middle" font-size="10px"></text>
                    </g>
                </g>
            </g>
            <g id="marker3" visibility="hidden">
                <line id="markerStalk_2_" fill="none" stroke="#808080" stroke-miterlimit="10" x1="216.1" y1="59.7"
                    x2="216.1" y2="73.6" />
                <rect id="marker3Bg" x="208.6" y="50.4" rx="3" ry="3" stroke="#808080" stroke-miterlimit="10" width="15"
                    height="15" />
                <text id="marker3Number" transform="matrix(1 0 0 1 216 61.5)" fill="#A8A8A8" font-family="'Open Sans'"
                    text-anchor="middle" font-size="10px"></text>
                <g>
                    <defs>
                        <rect id="npClip5" x="187.7" y="35.8" width="56.8" height="14.6" />
                    </defs>
                    <clipPath id="npClip6">
                        <use xlink:href="#npClip5" overflow="visible" />
                    </clipPath>
                    <g clip-path="url(#npClip6)">
                        <text id="nextMarkerName" transform="matrix(1 0 0 1 216 46.6)" fill="#A8A8A8"
                            font-family="'Open Sans'" text-anchor="middle" font-size="10px"></text>
                    </g>
                </g>
            </g>
            <g id=nextButton class="button" onClick="wwr_req(40173)">
                <path class="shadow" opacity="0.15" d="M248.3,83.5h29.6c17.8,0,32.3-14.4,32.3-32.3v-5.6h-64.6v35
            C245.6,82.4,246.8,83.5,248.3,83.5z" />
                <path fill="#1A1A1A" d="M248.3,12.5H278c18.4,0,33.4,15,33.4,33.4s-15,33.4-33.4,33.4h-29.7c-2,0-3.7-1.6-3.7-3.7V16.2
            C244.6,14.1,246.3,12.5,248.3,12.5L248.3,12.5z" />

                <linearGradient id="mrg1" gradientUnits="userSpaceOnUse" x1="-1856.4718" y1="405.6207" x2="-1856.4718"
                    y2="469.644" gradientTransform="matrix(-1 0 0 -1 -1578.4503 483.5079)">
                    <stop offset="0" style="stop-color:#262626" />
                    <stop offset="1" style="stop-color:#404040" />
                </linearGradient>
                <path fill="url(#mrg1)" d="M278,77.9c17.7,0,32-14.3,32-32s-14.3-32-32-32h-29.7c-1.2,0-2.3,1.1-2.3,2.3v59.4
            c0,1.4,1.1,2.3,2.3,2.3H278z" />
                <path opacity="5.000000e-02" d="M310.2,45.7H246v29.4c0,1.5,1.2,2.7,2.7,2.7h29.4
            C295.9,77.9,310.2,63.4,310.2,45.7L310.2,45.7z" />
                <path id="iconEnd" visibility="hidden" fill="#808080"
                    d="M279.4,46l-17.4-11.3v22.6L279.4,46z M281.4,34.7h5v22.6h-5V34.7z" />
                <path id="iconNext" fill="#808080" d="M279.4,46l-17.4-11.3v22.6L279.4,46z M278.7,34.7h10.4l-5.2,5L278.7,34.7z
             M281.4,42.2h5v15h-5V42.2z" />
                <path class="mouseover" visibility="hidden" opacity="0.05" fill="#FFFFFF" d="M278,77.9c17.7,0,32-14.3,32-32s-14.3-32-32-32h-29.7
            c-1.2,0-2.3,1.1-2.3,2.3v59.4c0,1.4,1.1,2.3,2.3,2.3H278z" />
            </g>
            <g id=prevButton class="button" onClick="wwr_req(40172)">
                <path class="shadow" opacity="0.15" d="M70.4,83.5H40.8C23,83.5,8.5,69,8.5,51.2v-5.6h64.6v35
            C73.1,82.4,71.9,83.5,70.4,83.5z" />
                <path fill="#1A1A1A" d="M70.4,12.5H40.7c-18.4,0-33.4,15-33.4,33.4s15,33.4,33.4,33.4h29.7c2,0,3.7-1.6,3.7-3.7V16.2
            C74.1,14.1,72.4,12.5,70.4,12.5L70.4,12.5z" />

                <linearGradient id="mrg2" gradientUnits="userSpaceOnUse" x1="-436.7075" y1="405.6207" x2="-436.7075"
                    y2="469.644" gradientTransform="matrix(1 0 0 -1 477.3987 483.5079)">
                    <stop offset="0" style="stop-color:#262626" />
                    <stop offset="1" style="stop-color:#404040" />
                </linearGradient>
                <path fill="url(#mrg2)" d="M40.7,77.9c-17.7,0-32-14.3-32-32s14.3-32,32-32h29.7c1.2,0,2.3,1.1,2.3,2.3v59.4
            c0,1.4-1.1,2.3-2.3,2.3H40.7z" />
                <path opacity="5.000000e-02" d="M8.5,45.7h64.2v29.4c0,1.5-1.2,2.7-2.7,2.7H40.6
            C22.8,77.9,8.5,63.4,8.5,45.7L8.5,45.7z" />
                <path id="iconHome" visibility="hidden" fill="#808080"
                    d="M39.3,46l17.4-11.3v22.6L39.3,46z M37.3,34.7h-5v22.6h5V34.7z" />
                <path id="iconPrev" fill="#808080" d="M39.3,46l17.4-11.3v22.6L39.3,46z M40,34.7H29.7l5.2,5L40,34.7z M37.3,42.2h-5v15
            h5V42.2z" />
                <path class="mouseover" visibility="hidden" opacity="0.05" fill="#FFFFFF" d="M40.7,77.9c-17.7,0-32-14.3-32-32s14.3-32,32-32h29.7
            c1.2,0,2.3,1.1,2.3,2.3v59.4c0,1.4-1.1,2.3-2.3,2.3H40.7z" />
            </g>
            <g id="dropMarker" class="button" visibility="hidden" onClick="insert_marker()">
                <rect x="145.2" y="40.7" fill-opacity="0.25" stroke="#808080" stroke-dasharray="2, 4"
                    stroke-miterlimit="10" rx="3" ry="3" width="28.4" height="28.4" />
                <path id="+" fill="none" stroke="#808080" stroke-width="3" stroke-miterlimit="10"
                    d="M159.4,63.3V46.5 M151.1,54.9h16.7" />
                <rect id="dropMarkerHitbox" x="131.2" y="35.2" fill="none" width="56.6" height="44" />
                <rect class="mouseover" visibility="hidden" x="145.2" y="40.7" opacity="0.15" fill="#FFFFFF"
                    width="28.4" height="28.4" />
            </g>
        </svg>

    </div>

    <div id="transport_r2">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            width="100%" height="100%" viewBox="0 0 303.6 107.6" xml:space="preserve">
            <circle id="playLineBg" fill="#222625" cx="151.8" cy="52.4" r="52.3" />
            <circle id="playLine" fill="none" stroke-dasharray="50" stroke-dashoffset="10" stroke="#00FE95"
                stroke-width="6" stroke-miterlimit="10" cx="151.8" cy="52.4" r="48" />

            <g id="play" class="button" onClick="wwr_req(1007)">
                <g id=playButtonOn visibility="hidden">
                    <path fill="#00FF99"
                        d="M151.8,97c-24.6,0-44.6-20-44.6-44.6s20-44.6,44.6-44.6s44.6,20,44.6,44.6S176.4,97,151.8,97z" />
                    <path fill="#1A1A1A" d="M151.8,8.4c24.3,0,44,19.7,44,44s-19.7,44-44,44s-44-19.7-44-44S127.5,8.4,151.8,8.4 M151.8,7.2
                    c-25,0-45.2,20.2-45.2,45.2s20.2,45.2,45.2,45.2S197,77.4,197,52.4S176.8,7.2,151.8,7.2L151.8,7.2z" />

                    <linearGradient id="pograd" gradientUnits="userSpaceOnUse" x1="151.7784" y1="-1823.5439"
                        x2="151.7784" y2="-1779.5526" gradientTransform="matrix(1 0 0 -1 0 -1771.1405)">
                        <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0.25" />
                        <stop offset="1" style="stop-color:#FFFFFF" />
                    </linearGradient>
                    <path opacity="0.15" fill="url(#pograd)" d="M195.8,52.4h-88l0,0c0-24.3,19.7-44,44-44l0,0
                    C176.2,8.4,195.8,28.1,195.8,52.4L195.8,52.4z" />
                    <polygon fill="#FFFFFF" points="139.6,67.9 139.6,37.1 170.4,52.4 		" />
                    <path class="mouseover" visibility="hidden" opacity="0.2" fill="#FFFFFF" d="M151.8,97c-24.6,0-44.6-20-44.6-44.6
                    s20-44.6,44.6-44.6s44.6,20,44.6,44.6S176.4,97,151.8,97z" />
                </g>
                <g id=playButtonOff visibility="visible">
                    <circle class="shadow" opacity="0.15" cx="151.8" cy="62.4" r="45.2" />

                    <linearGradient id="pffgrad" gradientUnits="userSpaceOnUse" x1="151.7784" y1="1033.0232"
                        x2="151.7784" y2="943.7836" gradientTransform="matrix(1 0 0 1 0 -936)">
                        <stop offset="0" style="stop-color:#697373" />
                        <stop offset="1" style="stop-color:#B0BBBB" />
                    </linearGradient>
                    <path fill="url(#pffgrad)"
                        d="M151.8,97c-24.6,0-44.6-20-44.6-44.6s20-44.6,44.6-44.6s44.6,20,44.6,44.6S176.4,97,151.8,97z" />
                    <path fill="#1A1A1A" d="M151.8,8.4c24.3,0,44,19.7,44,44s-19.7,44-44,44s-44-19.7-44-44S127.5,8.4,151.8,8.4 M151.8,7.2
                    c-25,0-45.2,20.2-45.2,45.2s20.2,45.2,45.2,45.2S197,77.4,197,52.4S176.8,7.2,151.8,7.2L151.8,7.2z" />

                    <linearGradient id="pffgrad2" gradientUnits="userSpaceOnUse" x1="151.7784" y1="-1823.5439"
                        x2="151.7784" y2="-1779.5526" gradientTransform="matrix(1 0 0 -1 0 -1771.1405)">
                        <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0.25" />
                        <stop offset="1" style="stop-color:#FFFFFF" />
                    </linearGradient>
                    <path opacity="0.15" fill="url(#pffgrad2)" d="M195.8,52.4h-88l0,0c0-24.3,19.7-44,44-44l0,0
                    C176.2,8.4,195.8,28.1,195.8,52.4L195.8,52.4z" />
                    <polygon fill="#1A1A1A" points="139.6,67.9 139.6,37.1 170.4,52.4 " />
                    <path class="mouseover" visibility="hidden" opacity="0.2" fill="#FFFFFF" d="M151.8,97c-24.6,0-44.6-20-44.6-44.6
                    s20-44.6,44.6-44.6s44.6,20,44.6,44.6S176.4,97,151.8,97z" />
                </g>
            </g>
            <g id="stopButton" class="button" onClick="wwr_req(40667)">
                <path class="shadow" opacity="0.15" d="M8.4,58.7c0,0.6,0,1.1,0,1.7v0c0,25.9,21,47,47,47h37
                c5.6,0,11-2.1,15.1-5.9c-10-10.8-16.1-25.2-16.1-41.1c0-0.6,0-1.1,0-1.7H8.4z" />
                <g>
                    <linearGradient id="stgrad" gradientUnits="userSpaceOnUse" x1="58.0022" y1="4.8047" x2="58.0022"
                        y2="100.002">
                        <stop offset="0" style="stop-color:#404040" />
                        <stop offset="1" style="stop-color:#262626" />
                    </linearGradient>
                    <path fill="url(#stgrad)"
                        d="M55.3,100C29.1,100,7.7,78.6,7.7,52.4S29.1,4.8,55.3,4.8h36.9c5.8,0,11.4,2.2,15.6,6.1l0.5,0.4
                    l-0.4,0.5C97.6,22.9,91.9,37.3,91.9,52.4c0,15.1,5.7,29.6,16,40.7l0.4,0.5l-0.5,0.4c-4.3,3.9-9.8,6-15.6,6H55.3z" />
                    <path fill="#1A1A1A" d="M92.2,5.4c5.6,0,11.1,2.1,15.2,5.9c-10,10.8-16.1,25.2-16.1,41.1c0,15.9,6.1,30.3,16.1,41.1
                    c-4.1,3.8-9.5,5.9-15.1,5.9h-37c-25.9,0-47-21-47-47v0c0-25.9,21-47,47-47H92.2 M92.2,4.2H55.3C28.7,4.2,7.1,25.8,7.1,52.4
                    c0,26.6,21.6,48.2,48.2,48.2h37c5.9,0,11.6-2.2,16-6.2l0.9-0.8l-0.9-0.9c-10.2-11-15.8-25.3-15.8-40.2c0-14.9,5.6-29.2,15.8-40.2
                    l0.9-0.9l-0.9-0.8C103.8,6.4,98.1,4.2,92.2,4.2L92.2,4.2z" />
                </g>
                <rect x="39.9" y="34.3" fill="#808080" width="32.9" height="32.9" />
                <linearGradient id="stgrad2" gradientUnits="userSpaceOnUse" x1="57.8796" y1="50.7389" x2="57.8796"
                    y2="5.4297">
                    <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0.25" />
                    <stop offset="1" style="stop-color:#FFFFFF" />
                </linearGradient>
                <path opacity="5.000000e-02" fill="url(#stgrad2)" d="M55.3,5.4C29.9,5.4,9.3,25.6,8.4,50.7h82.9c0.4-15.2,6.4-29,16.1-39.4l0,0
                c-4.1-3.8-9.5-5.9-15.1-5.9H55.3z" />
                <path opacity="5.000000e-02" d="M8.4,50.7c0,0.6,0,1.1,0,1.7v0c0,25.9,21,47,47,47h37c5.6,0,11-2.1,15.1-5.9
                c-10-10.8-16.1-25.2-16.1-41.1c0-0.6,0-1.1,0-1.7H8.4z" />
                <path class="mouseover" visibility="hidden" opacity="0.05" fill="#FFFFFF" d="M107.4,93.5c-10-10.8-16.1-25.2-16.1-41.1
                c0-15.9,6.1-30.3,16.1-41.1c-4.2-3.8-9.6-5.9-15.2-5.9H55.3c-25.9,0-47,21-47,47v0c0,25.9,21,47,47,47h37
                C97.9,99.4,103.3,97.3,107.4,93.5z" />
            </g>
            <g id="pause" class="button" onClick="wwr_req(1008)">
                <g id="pauseButtonOn" visibility="hidden">
                    <path class="shadow" opacity="0.15" d="M295.2,58.7c0,0.6,0,1.1,0,1.7v0c0,25.9-21,47-47,47h-37
                    c-5.6,0-11-2.1-15.1-5.9c10-10.8,16.1-25.2,16.1-41.1c0-0.6,0-1.1,0-1.7H295.2z" />
                    <path fill="#7DBBBB" stroke="#000000" stroke-width="1.25" stroke-miterlimit="10" d="M196.2,93.5c10-10.8,16.1-25.2,16.1-41.1
                    c0-15.9-6.1-30.3-16.1-41.1c4.2-3.8,9.6-5.9,15.2-5.9h36.9c25.9,0,47,21,47,47v0c0,25.9-21,47-47,47h-37
                    C205.7,99.4,200.3,97.3,196.2,93.5z" />
                    <path fill="#FFFFFF" d="M230.8,67.2h11V34.3h-11V67.2z M252.6,34.3v32.9h11V34.3H252.6z" />
                    <path class="mouseover" visibility="hidden" opacity="0.2" fill="#FFFFFF" d="M196.2,93.5c10-10.8,16.1-25.2,16.1-41.1
                    c0-15.9-6.1-30.3-16.1-41.1c4.2-3.8,9.6-5.9,15.2-5.9h36.9c25.9,0,47,21,47,47v0c0,25.9-21,47-47,47h-37
                    C205.7,99.4,200.3,97.3,196.2,93.5z" />
                </g>
                <g id="pauseButtonOff" visibility="visible">
                    <path class="shadow" opacity="0.15" d="M295.2,58.7c0,0.6,0,1.1,0,1.7v0c0,25.9-21,47-47,47h-37
                    c-5.6,0-11-2.1-15.1-5.9c10-10.8,16.1-25.2,16.1-41.1c0-0.6,0-1.1,0-1.7H295.2z" />
                    <g>
                        <linearGradient id="pfgrad" gradientUnits="userSpaceOnUse" x1="269.153" y1="4.8047" x2="269.153"
                            y2="100.002" gradientTransform="matrix(-1 0 0 1 514.7297 0)">
                            <stop offset="0" style="stop-color:#404040" />
                            <stop offset="1" style="stop-color:#262626" />
                        </linearGradient>
                        <path fill="url(#pfgrad)" d="M211.3,100c-5.8,0-11.3-2.1-15.6-6l-0.5-0.4l0.4-0.5c10.3-11.1,16-25.6,16-40.7
                        c0-15.1-5.7-29.5-15.9-40.6l-0.4-0.5l0.5-0.4c4.3-3.9,9.8-6.1,15.6-6.1h36.9c26.2,0,47.6,21.4,47.6,47.6S274.5,100,248.3,100
                        H211.3z" />
                        <path fill="#1A1A1A"
                            d="M248.3,5.4c25.9,0,47,21,47,47v0c0,25.9-21,47-47,47h-37c-5.6,0-11-2.1-15.1-5.9
                        c10-10.8,16.1-25.2,16.1-41.1c0-15.9-6.1-30.3-16.1-41.1c4.2-3.8,9.6-5.9,15.2-5.9H248.3 M248.3,4.2h-36.9
                        c-6,0-11.7,2.2-16.1,6.2l-0.9,0.8l0.9,0.9c10.2,11,15.8,25.3,15.8,40.2c0,15-5.6,29.2-15.8,40.2l-0.9,0.9l0.9,0.8
                        c4.4,4,10.1,6.2,16,6.2h37c26.6,0,48.2-21.6,48.2-48.2C296.5,25.8,274.9,4.2,248.3,4.2L248.3,4.2z" />
                    </g>
                    <path fill="#808080" d="M230.8,67.2h11V34.3h-11V67.2z M252.6,34.3v32.9h11V34.3H252.6z" />
                    <linearGradient id="pfgrad2" gradientUnits="userSpaceOnUse" x1="269.0302" y1="50.7389" x2="269.0302"
                        y2="5.4297" gradientTransform="matrix(-1 0 0 1 514.7297 0)">
                        <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0.25" />
                        <stop offset="1" style="stop-color:#FFFFFF" />
                    </linearGradient>
                    <path opacity="5.000000e-02" fill="url(#pfgrad2)" d="M248.3,5.4c25.4,0,46.1,20.1,46.9,45.3h-82.9c-0.4-15.2-6.4-29-16.1-39.4
                    l0,0c4.1-3.8,9.5-5.9,15.1-5.9H248.3z" />
                    <path opacity="5.000000e-02" d="M295.2,50.7c0,0.6,0,1.1,0,1.7v0c0,25.9-21,47-47,47h-37c-5.6,0-11-2.1-15.1-5.9
                    c10-10.8,16.1-25.2,16.1-41.1c0-0.6,0-1.1,0-1.7H295.2z" />
                    <path class="mouseover" visibility="hidden" opacity="0.05" fill="#FFFFFF" d="M196.2,93.5c10-10.8,16.1-25.2,16.1-41.1
                    c0-15.9-6.1-30.3-16.1-41.1c4.2-3.8,9.6-5.9,15.2-5.9h36.9c25.9,0,47,21,47,47v0c0,25.9-21,47-47,47h-37
                    C205.7,99.4,200.3,97.3,196.2,93.5z" />
                </g>
            </g>
        </svg>
    </div>

    <div style="width: 100%; background-color: #1a1a1a;">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            width="100%" height="100%" viewBox="0 0 320 47.2" xml:space="preserve">
            <text id="status" onClick="prompt_seek()" ; text-anchor="middle" ; transform="matrix(1 0 0 1 155.1 27.4)"
                font-family="'Open Sans'" font-size="26px"></text>
            <text id="timeUnits" text-anchor="middle" ; transform="matrix(1 0 0 1 155.1 39.4)" fill="#545454"
                font-family="'Open Sans'" font-size="9px">Hours:Minutes:Seconds:Frames</text>
            <text id="prevMarker" onmousedown="push_el(this, true);wwr_req(41820)" onmouseup="push_el(this, false)"
                x="55" y="37" text-anchor="middle" style="font-size: xx-large;">⏪️</text>
            <text id="nextMarker" onmousedown="push_el(this, true);wwr_req(41821)" onmouseup="push_el(this, false)"
                x="265" y="37" text-anchor="middle" style="font-size: xx-large;">⏩️</text>
        </svg>
    </div><br>

    <div id="transport_r3" style="display:block; margin: auto; align-items: center;">

        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            width="66%" height="100%" viewBox="0 0 201.4 108" xml:space="preserve">
            <path id="bg" fill="#262626"
                d="M151.7,99.5H48.6V0l103.1,0c27.5,0,49.7,22.3,49.7,49.7v0C201.4,77.2,179.2,99.5,151.7,99.5z" />
            <circle fill="#333333" cx="151.5" cy="49.4" r="26.4" />
            <g id="armed" class="button"><text id="armed_count" text-anchor="middle" transform="matrix(1 0 0 1 152 67)"
                    fill="#788282" font-family="'Open Sans'" font-weight="700" font-size="49px"></text>
                <path id="armed_text" fill="#5D3729"
                    d="M110.7,63.7l2-1.1l-1-3.7l-2.3,0l-0.9-3.3l12.3,0.6l1.1,4.1L111.7,67L110.7,63.7z M115,61.3l1.7-1c0.4-0.2,0.9-0.5,1.5-0.8c0.6-0.3,1-0.6,1.3-0.7c-0.3,0-0.7,0.1-1.4,0.1c-0.6,0-1.9,0-3.8,0.1L115,61.3z M119.4,71.7l-3.5,2.5l-1.8-2.6l9.5-6.8l2.2,3.1c1.8,2.6,1.8,4.5,0,5.9c-1.1,0.8-2.3,0.9-3.7,0.2l-2.2,5.7l-2.1-2.9l2-4.5	L119.4,71.7z M121.4,70.3l0.3,0.5c0.6,0.9,1.4,1.1,2.1,0.5c0.7-0.5,0.7-1.1,0-2l-0.4-0.5L121.4,70.3z M129.1,87l-5.6-4.1l7-9.4 l5.6,4.1l-1.5,2l-3-2.3l-1.1,1.5l2.8,2.1l-1.5,2l-2.8-2.1l-1.3,1.8l3,2.3L129.1,87z M147.5,93.2l-0.2-2.3l-3.7-0.6l-0.9,2.1 l-3.4-0.6l5.6-11l4.2,0.7l1.9,12.2L147.5,93.2z M147,88.3l-0.2-2c0-0.4-0.1-1-0.2-1.7c-0.1-0.7-0.1-1.2-0.1-1.5 c-0.1,0.3-0.3,0.7-0.5,1.3c-0.2,0.6-0.7,1.8-1.5,3.5L147,88.3z M158.4,88.6l0.8,4.2l-3.1,0.6l-2.2-11.5l3.8-0.7 c3.1-0.6,4.9,0.2,5.3,2.5c0.3,1.3-0.2,2.5-1.4,3.5l4.3,4.4l-3.5,0.7l-3.2-3.7L158.4,88.6z M157.9,86.3l0.6-0.1 c1.1-0.2,1.5-0.8,1.3-1.7c-0.2-0.8-0.8-1.1-1.8-0.9l-0.6,0.1L157.9,86.3z M175.3,86.7l-6.7-5.6l-0.1,0c0.9,1.1,1.6,2,2,2.7l2.9,4.2 l-2.3,1.6l-6.6-9.6l3.5-2.4l6.7,5.5l0.1,0l-2.7-8.2l3.5-2.4L182,82l-2.4,1.6l-2.9-4.2c-0.2-0.2-0.3-0.5-0.5-0.7 c-0.2-0.3-0.6-1-1.3-2l-0.1,0l2.8,8.3L175.3,86.7z M190.2,71.1l-3.9,5.7l-9.7-6.5l3.9-5.7l2.1,1.4l-2.1,3.1l1.5,1l2-2.9l2.1,1.4 l-2,2.9l1.8,1.2l2.1-3.1L190.2,71.1z M189.5,54.8c1.9,0.5,3.2,1.4,3.9,2.7c0.7,1.3,0.8,2.9,0.3,4.8l-1,3.6l-11.3-3.1l1.1-3.9 c0.5-1.8,1.3-3.1,2.5-3.8C186.2,54.4,187.7,54.3,189.5,54.8z M188.7,58c-1-0.3-1.9-0.3-2.5,0c-0.6,0.3-1,0.8-1.3,1.7l-0.2,0.9	l6.3,1.7l0.2-0.7c0.3-0.9,0.2-1.7-0.2-2.3C190.6,58.7,189.8,58.3,188.7,58z M128.1,27.2l-2.1,2.4l-6.9-5.9l-1.9,2.2l-2-1.7l5.8-6.7 l2,1.7l-1.8,2.2L128.1,27.2z M132.1,18.5l2.2,3.7l-2.7,1.6l-5.9-10.1l3.3-1.9c2.7-1.6,4.7-1.4,5.9,0.6c0.7,1.2,0.6,2.4-0.1,3.7 l5.5,2.7l-3.1,1.8l-4.3-2.4L132.1,18.5z M130.9,16.5l0.5-0.3c0.9-0.6,1.2-1.3,0.7-2.1c-0.4-0.7-1.1-0.8-2-0.2l-0.5,0.3L130.9,16.5z M148.6,17.2l-0.9-2.1l-3.7,0.6l-0.2,2.3l-3.4,0.6l1.8-12.2l4.2-0.7l5.8,10.9L148.6,17.2z M146.6,12.7l-0.8-1.8	c-0.2-0.4-0.4-0.9-0.7-1.6c-0.3-0.6-0.5-1.1-0.6-1.4c0,0.3,0,0.7-0.1,1.4s-0.1,1.9-0.3,3.8L146.6,12.7z M160.4,8.9 c-0.7-0.1-1.4,0.1-1.9,0.6c-0.5,0.5-0.9,1.3-1.1,2.4c-0.4,2.2,0.2,3.5,1.9,3.8c0.5,0.1,1,0.1,1.5,0.1s1-0.1,1.5-0.2l-0.5,2.6	c-1,0.2-2.2,0.2-3.4,0c-1.7-0.3-3-1.1-3.7-2.3c-0.7-1.2-0.9-2.7-0.6-4.6c0.2-1.2,0.6-2.2,1.3-3c0.6-0.8,1.4-1.4,2.3-1.7	s2-0.4,3.1-0.2c1.2,0.2,2.4,0.7,3.4,1.5l-1.4,2.3c-0.4-0.3-0.8-0.5-1.2-0.7C161.3,9.1,160.9,9,160.4,8.9z M172.8,24.6l-3.1-1.8 l0.3-5l-1.1,0l-2,3.4l-2.7-1.6l6-10l2.7,1.6l-2.6,4.4c0.3-0.2,0.8-0.5,1.6-0.8l3.9-1.8l3,1.8l-5.8,2.6L172.8,24.6z M181.5,29.4 c-0.6,0.5-1.2,0.7-1.8,0.8c-0.7,0.1-1.3,0-2-0.4c-0.7-0.3-1.3-0.8-1.9-1.6c-0.5-0.6-0.9-1.1-1.1-1.6c-0.3-0.5-0.5-1-0.6-1.6 l2.1-1.8c0.2,0.7,0.4,1.3,0.7,1.9c0.3,0.6,0.6,1.1,1,1.5c0.3,0.4,0.6,0.6,0.9,0.6s0.5,0,0.7-0.2c0.1-0.1,0.2-0.2,0.2-0.4 c0-0.1,0-0.3,0-0.6c0-0.2-0.2-0.8-0.4-1.7c-0.2-0.8-0.3-1.5-0.3-2c0-0.5,0.1-1,0.3-1.4c0.2-0.4,0.5-0.8,1-1.2 c0.8-0.7,1.7-0.9,2.7-0.7c1,0.2,1.9,0.8,2.8,1.9c0.8,0.9,1.4,2,1.8,3.4l-2.5,0.8c-0.3-1.2-0.7-2-1.3-2.6c-0.3-0.3-0.5-0.5-0.7-0.5	s-0.4,0-0.6,0.1c-0.2,0.1-0.3,0.4-0.2,0.7c0,0.3,0.2,1,0.5,2.1c0.3,1.1,0.4,1.9,0.2,2.5C182.4,28.3,182.1,28.9,181.5,29.4z" />
            </g>
            <g id="abort" class="button" style="visibility:hidden" onClick="prompt_abort()">
                <path id="abort_text" fill="#FF2200"
                    d="M113.5,57.4l-4.1,0.9l-0.7-3.1l11.4-2.6l0.8,3.7c0.7,3.1-0.1,4.9-2.3,5.4 c-1.3,0.3-2.5-0.1-3.5-1.2l-4.2,4.4l-0.8-3.5l3.6-3.4L113.5,57.4z M115.9,56.9l0.1,0.6c0.2,1.1,0.8,1.5,1.8,1.3 c0.8-0.2,1.1-0.8,0.8-1.8l-0.1-0.6L115.9,56.9z M116.6,75.3l-3.5-6l10-6l3.5,6l-2.2,1.3l-1.9-3.2l-1.6,0.9l1.8,3l-2.2,1.3l-1.8-3 l-1.9,1.1l1.9,3.2L116.6,75.3z M130.1,76.2c-0.6-0.5-1.2-0.7-1.9-0.5c-0.7,0.2-1.4,0.7-2.2,1.5c-1.5,1.7-1.6,3.1-0.3,4.2 c0.4,0.3,0.8,0.6,1.3,0.8c0.5,0.2,0.9,0.4,1.4,0.6l-1.8,2c-1-0.3-2-0.9-2.9-1.7c-1.3-1.2-2-2.5-2-3.8c0-1.4,0.6-2.8,1.9-4.2 c0.8-0.9,1.7-1.5,2.6-1.9c0.9-0.4,1.9-0.5,2.9-0.3c1,0.2,1.9,0.7,2.7,1.5c0.9,0.8,1.7,1.8,2.2,3l-2.4,1.2c-0.2-0.4-0.4-0.9-0.6-1.2 C130.8,76.9,130.5,76.5,130.1,76.2z M143.9,87c-0.7,1.8-1.7,3.1-3,3.7c-1.3,0.6-2.8,0.6-4.5-0.1c-1.7-0.7-2.8-1.6-3.4-2.9	c-0.5-1.3-0.5-2.9,0.2-4.7c0.7-1.8,1.7-3,3-3.6c1.3-0.6,2.8-0.6,4.5,0.1c1.7,0.7,2.9,1.6,3.4,2.9C144.7,83.6,144.6,85.2,143.9,87z M136.4,84.1c-0.8,2.1-0.5,3.4,1,4c0.7,0.3,1.4,0.2,2-0.1c0.6-0.4,1-1.1,1.5-2.2c0.4-1.1,0.5-2,0.4-2.6c-0.2-0.7-0.6-1.1-1.3-1.4 C138.3,81.2,137.2,82,136.4,84.1z M151.1,89.1l0.1,4.2l-3.2,0.1l-0.2-11.7l3.8-0.1c3.2-0.1,4.8,1.1,4.8,3.4c0,1.4-0.6,2.4-1.9,3.2	l3.5,5l-3.6,0.1l-2.5-4.2L151.1,89.1z M151.1,86.7l0.6,0c1.1,0,1.6-0.5,1.6-1.5c0-0.8-0.6-1.2-1.6-1.2l-0.6,0L151.1,86.7z M170,83.1c0.7,1.8,0.7,3.4,0.1,4.8c-0.6,1.4-1.9,2.4-3.7,3.1l-3.5,1.3l-4.1-10.9l3.8-1.4c1.8-0.7,3.3-0.7,4.6-0.2	C168.4,80.3,169.4,81.4,170,83.1z M167,84.3c-0.4-1-0.9-1.7-1.4-2c-0.6-0.3-1.3-0.4-2.1,0l-0.9,0.3l2.3,6.1l0.7-0.2	c0.9-0.3,1.5-0.8,1.7-1.5C167.5,86.3,167.4,85.4,167,84.3z M176.7,85.7l-7-9.4l2.5-1.9l7,9.4L176.7,85.7z M190.5,71l-2.4,3.3 l-9.2-1.4l0,0.1c1.1,0.7,1.9,1.2,2.5,1.6l4.3,3.1l-1.6,2.3l-9.4-6.9l2.4-3.3l9.1,1.3l0,0c-1-0.6-1.8-1.2-2.4-1.6l-4.3-3.1l1.7-2.3	L190.5,71z M187.6,58.6l1.2-4.9l6.1,1.5c0.1,1.4,0,3-0.4,4.6c-0.4,1.7-1.3,3-2.5,3.7c-1.2,0.7-2.8,0.8-4.7,0.4	c-1.8-0.4-3.1-1.3-3.9-2.6c-0.8-1.3-0.9-2.9-0.5-4.8c0.2-0.7,0.4-1.4,0.7-2c0.3-0.6,0.6-1.1,0.9-1.5l2.2,1.6 c-0.6,0.7-1,1.6-1.3,2.5c-0.2,0.9-0.1,1.7,0.4,2.3c0.5,0.6,1.2,1.1,2.3,1.3c1.1,0.3,1.9,0.2,2.6-0.1c0.7-0.3,1.1-0.9,1.3-1.7 c0.1-0.5,0.2-0.9,0.2-1.3l-1.8-0.4l-0.5,2L187.6,58.6z M132.4,23.3l-1.9-1.3l-2.9,2.5l1,2l-2.6,2.3l-4.8-11.4l3.2-2.7l10.6,6.4 L132.4,23.3z M128.4,20.5l-1.6-1.1c-0.4-0.2-0.8-0.6-1.4-1c-0.6-0.4-1-0.7-1.2-0.9c0.1,0.2,0.4,0.6,0.7,1.2 c0.3,0.6,0.9,1.7,1.7,3.4L128.4,20.5z M132.6,9.6l3.8-1.4c1.5-0.5,2.7-0.7,3.6-0.5c0.9,0.2,1.5,0.7,1.8,1.7 c0.2,0.6,0.3,1.2,0.1,1.7c-0.2,0.5-0.5,1-0.9,1.3l0,0.1c0.7-0.1,1.3,0.1,1.8,0.4s0.8,0.8,1.1,1.5c0.4,1,0.3,1.9-0.3,2.8 c-0.5,0.8-1.5,1.5-2.7,2l-4.3,1.5L132.6,9.6z M137.1,12.7l0.9-0.3c0.4-0.2,0.7-0.4,0.9-0.6c0.2-0.3,0.2-0.6,0.1-0.9 c-0.2-0.6-0.8-0.8-1.7-0.4l-0.8,0.3L137.1,12.7z M137.9,14.9l0.8,2.3l1-0.4c0.9-0.3,1.2-0.9,1-1.7c-0.1-0.4-0.4-0.6-0.7-0.7 c-0.3-0.1-0.7-0.1-1.2,0.1L137.9,14.9z M158.4,11.5c-0.1,2-0.6,3.4-1.6,4.4c-1,1-2.4,1.5-4.3,1.4c-1.8-0.1-3.2-0.6-4.2-1.7	c-0.9-1.1-1.4-2.6-1.3-4.5c0.1-1.9,0.6-3.4,1.6-4.4c1-1,2.4-1.5,4.3-1.4c1.9,0.1,3.3,0.6,4.2,1.7C158,8,158.4,9.5,158.4,11.5z M150.3,11.3c-0.1,2.3,0.7,3.4,2.3,3.5c0.8,0,1.4-0.2,1.8-0.8c0.4-0.5,0.6-1.4,0.7-2.5c0-1.2-0.1-2-0.5-2.6 c-0.4-0.6-0.9-0.9-1.7-0.9C151.2,7.9,150.4,9,150.3,11.3z M165,15.5l-1.7,3.9l-2.9-1.3l4.7-10.7l3.5,1.5c2.9,1.3,3.9,3,3,5.1 c-0.5,1.2-1.6,1.9-3.1,2.1l1.1,6l-3.3-1.4l-0.6-4.9L165,15.5z M166,13.3l0.5,0.2c1,0.4,1.7,0.2,2.1-0.7c0.3-0.7,0-1.3-1-1.8 l-0.6-0.2L166,13.3z M174.4,26.7l-2.3-2.1l6.1-6.7l-2.1-1.9l1.7-1.9l6.5,6l-1.7,1.9l-2.1-1.9L174.4,26.7z" />
                <polygon id="abort_cross" visibility="hidden" fill="#FF2200"
                    points="171.9,37.8 163.6,29.5 151.7,41.4 139.8,29.5 131.5,37.8 143.4,49.7 131.5,61.6 139.8,69.9 151.7,58 163.6,69.9 171.9,61.6 160,49.7" />
                <circle class="mouseover" visibility="hidden" opacity="0.05" fill="#FFFFFF" cx="151.4" cy="49.7"
                    r="49.7" />
            </g>
            <g id="button-record" onClick="on_record_button()">
                <g id="record_off" class="button">
                    <circle class="shadow" opacity="0.15" cx="50.4" cy="58.3" r="49.7" />
                    <path fill="#5D3729"
                        d="M49.7,98.8c-27.1,0-49-21.9-49-49s21.9-49,49-49s49,21.9,49,49S76.9,98.8,49.7,98.8z" />
                    <path fill="#1A1A1A"
                        d="M49.7,1.4c26.7,0,48.3,21.7,48.3,48.3S76.5,98.1,49.7,98.1S1.4,76.5,1.4,49.7S23,1.4,49.7,1.4 M49.7,0           C22.3,0,0,22.3,0,49.7s22.3,49.7,49.7,49.7s49.7-22.3,49.7-49.7S77.2,0,49.7,0L49.7,0z" />
                    <linearGradient id="rec_off1" gradientUnits="userSpaceOnUse" x1="49.7368" y1="-879.7368"
                        x2="49.7368" y2="-831.4211" gradientTransform="matrix(1 0 0 -1 0 -830)">
                        <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0.25" />
                        <stop offset="1" style="stop-color:#FFFFFF" />
                    </linearGradient>
                    <path opacity="0.15" fill="url(#rec_off1)"
                        d="M98.1,49.7H1.4l0,0C1.4,23,23,1.4,49.7,1.4l0,0 C76.6,1.4,98.1,23,98.1,49.7L98.1,49.7z" />
                    <circle opacity="0.5" fill="none" stroke="#FFFFFF" stroke-width="11.0527" stroke-miterlimit="10"
                        cx="49.7" cy="49.7" r="23.3" />
                    <path class="mouseover" visibility="hidden" opacity="0.1" fill="#FFFFFF"
                        d="M49.7,98.8c-27.1,0-49-21.9-49-49s21.9-49,49-49s49,21.9,49,49 S76.9,98.8,49.7,98.8z" />
                </g>
                <g id="record_on" class="button" visibility="hidden">
                    <path fill="#FF2200"
                        d="M49.7,98.8c-27.1,0-49-21.9-49-49s21.9-49,49-49s49,21.9,49,49S76.9,98.8,49.7,98.8z" />
                    <path fill="#1A1A1A"
                        d="M49.7,1.4c26.7,0,48.3,21.7,48.3,48.3S76.5,98.1,49.7,98.1S1.4,76.5,1.4,49.7S23,1.4,49.7,1.4 M49.7,0 C22.3,0,0,22.3,0,49.7s22.3,49.7,49.7,49.7s49.7-22.3,49.7-49.7S77.2,0,49.7,0L49.7,0z" />
                    <circle opacity="0.5" fill="none" stroke="#FFFFFF" stroke-width="11.0527" stroke-miterlimit="10"
                        cx="49.7" cy="49.7" r="23.3" />
                    <path class="mouseover" visibility="hidden" opacity="0.2" fill="#FFFFFF"
                        d="M49.7,98.8c-27.1,0-49-21.9-49-49s21.9-49,49-49s49,21.9,49,49 S76.9,98.8,49.7,98.8z" />
                </g>
            </g>
        </svg>
    </div>

    <div style="width: 100%; background-color: #1a1a1a;">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            width="100%" height="100%" viewBox="0 0 320 47.2" xml:space="preserve">
            <text id="bpm_status" onClick="enterBPM()" ; text-anchor="middle" ; transform="matrix(1 0 0 1 155.1 27.4)"
                font-family="'Open Sans'" font-size="26px">-</text>
            <text id="bpm_txt" text-anchor="middle" ; transform="matrix(1 0 0 1 155.1 39.4)" fill="#545454"
                font-family="'Open Sans'" font-size="9px">BPM</text>
            <text id="bpm_minus" onmousedown="push_el(this, true);wwr_req('41821;41820;41130')"
                onmouseup="push_el(this, false)" x="55" y="37" text-anchor="middle"
                style="font-size: xx-large;">➖</text>
            <text id="bpm_plus" onmousedown="push_el(this, true);wwr_req('41821;41820;41129')"
                onmouseup="push_el(this, false)" x="265" y="37" text-anchor="middle"
                style="font-size: xx-large;">➕</text>
        </svg>
    </div>

    <div style="width: 100%;">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            width="100%" height="100%" viewBox="0 0 320 40" xml:space="preserve">
            <text id="pre_roll_play_text" text-anchor="start" ; transform="matrix(1 0 0 1 90 28)"
                font-family="'Open Sans'" font-size="17px" style="fill: #A9ABAB;">Pre-roll before playback</text>
            <text id="pre_roll_play_box" onmousedown="push_el(this, true);wwr_req(cmd_pre_roll_play)"
                x="55" y="33" text-anchor="middle" style="font-size: xx-large;">☑️</text>
        </svg>
    </div>

    <div style="width: 100%;">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            width="100%" height="100%" viewBox="0 0 320 40" xml:space="preserve">
            <text id="pre_roll_rec_text" text-anchor="start" ; transform="matrix(1 0 0 1 90 28)"
                font-family="'Open Sans'" font-size="17px" style="fill: #A9ABAB;">Pre-roll before recording</text>
            <text id="pre_roll_rec_box" onmousedown="push_el(this, true);wwr_req(cmd_pre_roll_rec)"
                x="55" y="33" text-anchor="middle" style="font-size: xx-large;">☑️</text>
        </svg>
    </div>

    <div id="backLoad" style="display:none"></div>

</body>

</html>


<!--TO DO : change colours when colours change to default -->

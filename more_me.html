<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0" />

    <title>WaveHit REAPER Web Control</title>
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,700" rel="stylesheet" type="text/css">
    <script src="main.js"></script>

    <style type="text/css">
        body {
            background-color: #333333;
            color: #A9ABAB;
            font-family: 'Open Sans', sans-serif;
            font-size: 1em;
            text-align: center;
            margin: 0px;
            user-select: none;
            cursor: default;
        }

        #trackSelect {
            width: 100%;
            color: #A9ABAB;
            background-color: #262626;
            border: none;
            font-size: 1.5em;
            padding: 3%;
            -webkit-border-radius: 20px;
            -moz-border-radius: 20px;
            border-radius: 20px;
            -webkit-appearance: none;
        }

        #trackSelect_in {
            width: 100%;
            color: #A9ABAB;
            background-color: #262626;
            border: none;
            font-size: 1.5em;
            padding: 3%;
            -webkit-border-radius: 20px;
            -moz-border-radius: 20px;
            border-radius: 20px;
            -webkit-appearance: none;
        }

        #markerSelect {
            width: 100%;
            color: #A9ABAB;
            background-color: #262626;
            border: none;
            font-size: 1.5em;
            padding: 3%;
            -webkit-border-radius: 20px;
            -moz-border-radius: 20px;
            border-radius: 20px;
            -webkit-appearance: none;
        }

        select option:first-child {
            color: #555555;
            font-style: italic;
        }

        #instructions {
            display: block;
            padding: 0% 10% 0% 10%;
        }

        .button:hover .mouseover {
            visibility: visible;
        }

        .button:active .mouseover {
            visibility: hidden;
            pointer-events: all;
        }

        .button:active .shadow {
            visibility: hidden;
        }

        .button:active .gloss {
            visibility: hidden;
        }

        .button:active .active {
            visibility: visible;
        }
    </style>

    <script type="text/javascript">

        wwr_req_recur("NTRACK;TRACK;BEATPOS;TRANSPORT", 10);
        wwr_req_recur("MARKER;REGION", 500);
        wwr_start();

        var nTrack = 0, nTrackOld = 0, trackNameAr = [], trackRcvCntAr = [], trackHwOutCntAr = [], receiveIdxAr = [], receiveVolAr = [], receiveMuteAr = [], trackColoursAr = [], trackIsMonitorAr = [], trackIsMonitorArOld = [], selectChoiceIdx = 0, selectChoiceOld = "", mouseDown = 0, sendOutputdB = 0,
            selectInputIdx = 0, selectInputOld = -1, trackMutedAr = [], trackHasFxAr = [], pos_sec = 0, pos_sec_prev = 0, trackRecAr = [],
            pos_beat = 0, pos_beat_prev = 0, playstate = 0, MarkersAr = [], currMarker = -1, selectMarkerIdx = -1, selectMarkerOld = -1, once = true,

            last_transport_state = -1, drawnSig = 0, drawnBeat = 0, playPosSeconds = 0, newPos = -1;

        function lumaOffset(c) {
            var c = c.substring(1);
            var rgb = parseInt(c, 16);
            var r = (rgb >> 16) & 0xff;
            var g = (rgb >> 8) & 0xff;
            var b = (rgb >> 0) & 0xff;
            var luma = 0.2126 * r + 0.7152 * g + 0.0722 * b;
            function componentToHex(c) {
                var hex = c.toString(16);
                return hex.length == 1 ? "0" + hex : hex;
            }
            if (luma < 150) { r = r + 150; g = g + 150; b = b + 150 }
            if (luma > 150) { r = r - 120; g = g - 120; b = b - 120 }
            if (r < 0) { r = 0 }; if (g < 0) { g = 0 }; if (b < 0) { b = 0 }
            if (r > 255) { r = 255 }; if (g > 255) { g = 255 }; if (b > 255) { b = 255 }
            return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
        }

        function elAttribute(id, attribute, value) {
            if (document.getElementById(id)) {
                document.getElementById(id).setAttributeNS(null, attribute, value);
            }
        }

        function mouseDownEventActivate(msg, button) {
            return function (e) {
                if (button.value == 0) {
                    button.style.backgroundColor = "tomato";
                    button.value = 1;
                }
                else {
                    button.style.backgroundColor = "gray";
                    button.value = 0;
                }

                if (typeof e == 'undefined') e = event;
                if (e.preventDefault) e.preventDefault();
                wwr_req(msg);
                return false;
            }
        }

        function mouseDownEventHandler(msg) {
            return function (e) {
                if (typeof e == 'undefined') e = event;
                if (e.preventDefault) e.preventDefault();
                wwr_req(msg);
                return false;
            }
        }

        function mouseUpHandler(event) { mouseDown = 0; }
        function mouseDownHandler(event, target) { mouseDown = 1; }
        function mouseLeaveHandler(event) { mouseDown = 0; }
        function mouseMoveHandler(event) {
            if (mouseDown != 1) { return; }
            else {
                var volTrackWidth = (this.getBoundingClientRect()["width"]);
                var volThumbWidth = volTrackWidth * 0.14375;
                var volThumbTrackWidth = (volTrackWidth - volThumbWidth);
                var volThumbTrackLEdge = this.getBoundingClientRect()["left"];
                offsetX = (event.pageX - volThumbTrackLEdge - (volThumbWidth / 2));

                if (event.changedTouches != undefined) { //we're doing touch stuff
                    offsetX = (event.changedTouches[0].pageX - volThumbTrackLEdge - (volThumbWidth / 2));
                }
                if (offsetX < 0) { offsetX = 0 };
                if (offsetX > volThumbTrackWidth) { offsetX = volThumbTrackWidth };

                var volThumb = this.getElementsByClassName("fader")[0];
                var offsetX320 = offsetX * (320 / volTrackWidth);
                var vteMove320 = "translate(" + offsetX320 + " 0)";
                volThumb.setAttributeNS(null, "transform", vteMove320);
                var volOutput = (offsetX / volThumbTrackWidth);
                var volOutputdB = Math.pow(volOutput, 4) * 4;
                wwr_req("SET/TRACK/" + selectChoiceIdx + "/SEND/" + -this.id + "/VOL/" + volOutputdB)
            }
        }
        function sendMouseMoveHandler(event) {
            if (mouseDown != 1) { return; }
            else {
                var sendTrackWidth = this.getElementsByClassName("sendBg")[0].getBoundingClientRect()["width"];
                var sendThumbWidth = this.getElementsByClassName("sendBg")[0].getBoundingClientRect()["height"];
                var sendThumbTrackWidth = (sendTrackWidth - sendThumbWidth);
                var sendThumbTrackLEdge = this.getElementsByClassName("sendBg")[0].getBoundingClientRect()["left"];

                offsetX = event.pageX - sendThumbTrackLEdge - (sendThumbWidth / 2);
                if (event.changedTouches != undefined) { //we're doing touch stuff
                    offsetX = (event.changedTouches[0].pageX - sendThumbTrackLEdge - (sendThumbWidth / 2));
                }
                if (offsetX < 0) { offsetX = 0 };
                if (offsetX > sendThumbTrackWidth) { offsetX = sendThumbTrackWidth };

                var offsetX262 = offsetX * (262 / sendTrackWidth) + 26;
                var sendThumb = this.getElementsByClassName("sendThumb")[0];
                sendThumb.setAttributeNS(null, "cx", offsetX262);
                var sendLine = this.getElementsByClassName("sendLine")[0];
                sendLine.setAttributeNS(null, "x2", offsetX262);

                var sendOutput = (offsetX / sendThumbTrackWidth);
                sendOutputdB = Math.pow(sendOutput, 4) * 4;
                wwr_req("SET/TRACK/" + selectChoiceIdx + "/SEND/" + -this.id + "/VOL/" + sendOutputdB)
            }
        }

        function sendMouseUpHandler(event) {
            wwr_req("SET/TRACK/" + selectChoiceIdx + "/SEND/" + -this.id + "/VOL/" + sendOutputdB + "e");
            mouseDown = 0;
        }

        function volFaderConect(content, thumb) {
            content.addEventListener("mousemove", mouseMoveHandler, false);
            content.addEventListener("touchmove", mouseMoveHandler, false);
            content.addEventListener("mouseleave", mouseLeaveHandler, false);
            content.addEventListener("mouseup", mouseUpHandler, false);
            content.addEventListener("touchend", mouseUpHandler, false);
            thumb.addEventListener("mousedown", function (event) { mouseDownHandler(event, event.srcElement) }, false);
            thumb.addEventListener('touchstart', function (event) {
                if (event.touches.length > 0) mouseDownHandler(event, event.srcElement);
                event.preventDefault();
            }, false);
        }

        function sendConect(content, thumb) {
            content.addEventListener("mousemove", sendMouseMoveHandler, false);
            content.addEventListener("touchmove", sendMouseMoveHandler, false);
            content.addEventListener("mouseleave", mouseLeaveHandler, false);
            content.addEventListener("mouseup", sendMouseUpHandler, false);
            content.addEventListener("touchend", sendMouseUpHandler, false);
            thumb.addEventListener("mousedown", function (event) { mouseDownHandler(event, event.srcElement) }, false);
            thumb.addEventListener('touchstart', function (event) {
                if (event.touches.length > 0) mouseDownHandler(event, event.srcElement);
                event.preventDefault();
            }, false);
        }

        function toColor(num) {
            num >>>= 0;
            var b = num & 0xFF,
                g = (num & 0xFF00) >>> 8,
                r = (num & 0xFF0000) >>> 16,
                a = (num & 0xF000000) >>> 24;
            return a == 0 ? "" : "rgba(" + [r, g, b, a].join(",") + ")";
        }

        function currBPM() {
            return Math.round((pos_beat - pos_beat_prev) / (pos_sec - pos_sec_prev) * 60);
        }

        function wwr_onreply(results) {
            var resultsDisplay = document.getElementById("_results");
            if (resultsDisplay != null) {
                resultsDisplay.innerHTML = results;
            }

            var ar = results.split("\n");
            for (var x = 0; x < ar.length; x++) {
                var tok = ar[x].split("\t");
                if (tok.length > 0) switch (tok[0]) {
                    case "NTRACK":
                        if (tok.length > 1) {
                            nTrack = parseInt(tok[1]) + 1;
                            if (nTrack != nTrackOld) {
                                trackRcvCntAr = [];
                                nTrackOld = nTrack;
                            }
                        }
                        break;
                    case "TRACK":
                        idx = parseInt(tok[1]);

                        if (tok[2] != trackNameAr[idx]) {
                            trackNameAr[idx] = tok[2];
                        }

                        if (tok[11] != trackRcvCntAr[idx]) {
                            trackRcvCntAr[idx] = tok[11];
                        }

                        if (tok[12] != trackHwOutCntAr[idx]) {
                            trackHwOutCntAr[idx] = tok[12];
                        }

                        if (tok[13] > 0 && tok[13] != trackColoursAr[idx]) {
                            trackColoursAr[idx] = tok[13];
                        }

                        if (tok[3] & 8) {
                            trackMutedAr[idx] = 1;
                        }
                        else { trackMutedAr[idx] = 0; }

                        trackHasFxAr[idx] = tok[3] & 4 ? 1 : 0;

                        trackRecAr[idx] = tok[3] & 64 ? 1 : 0;

                        break;

                    case "SEND":
                        if (tok.length > 3) {
                            var f = -tok[2] - 1;
                            receiveIdxAr[f] = tok[6];
                            receiveVolAr[f] = tok[4];
                            if (tok[6] == -1) { var hardVol = tok[4] }
                            if (tok[3] & 8) { receiveMuteAr[f] = 1 }
                            else { receiveMuteAr[f] = 0 }
                        }
                        break;

                    case "BEATPOS":
                        pos_sec_prev = pos_sec;
                        pos_beat_prev = pos_beat;
                        pos_sec = tok[2];
                        pos_beat = tok[3];
                        playstate = tok[1];

                        var playLine = document.querySelector('#playLine');
                        if (tok.length > 5 && playLine) {
                            var playLineCirc = 301.1;
                            var playLineArc = playLineCirc - (playLineCirc / tok[6]);
                            //var playLineRotate = (360 / tok[6]) * tok[5]; //freewheeling play line
                            thisBeat = Math.round(tok[5]);
                            var playLineRotate = (360 / tok[6]) * thisBeat;
                            thisSig = tok[6];
                            if (drawnSig != thisSig || drawnBeat != thisBeat && playLine) {
                                playLine.setAttributeNS(null, "stroke-dasharray", playLineCirc);
                                playLine.setAttributeNS(null, "stroke-dashoffset", playLineArc);
                                playLine.setAttribute("transform", "rotate(" + playLineRotate + ",151.8,52.4)");
                            }
                        }

                        break;

                    case "MARKER":
                        var marker = [tok[1], tok[2], tok[3], toColor(tok[4])];
                        MarkersAr.push(marker);
                        g_markers.push(tok);
                        break;

                    case "MARKER_LIST":
                        MarkersAr = [];
                        g_markers = [];
                        break;

                    case "TRANSPORT":
                        if (tok.length > 4) {
                            var backLoaded = document.getElementById("backLoad");
                            if (backLoaded != null) {
                                if (tok[1] != last_transport_state) {
                                    last_transport_state = tok[1];
                                    document.getElementById("playButtonOff").style.visibility = (last_transport_state & 1) ? "hidden" : "visible";
                                    document.getElementById("playButtonOn").style.visibility = (last_transport_state & 1) ? "visible" : "hidden";
                                    document.getElementById("pauseButtonOff").style.visibility = (last_transport_state & 2) ? "hidden" : "visible";
                                    document.getElementById("pauseButtonOn").style.visibility = (last_transport_state & 2) ? "visible" : "hidden";
                                }
                                if (tok[2] != playPosSeconds) { playPosSeconds = tok[2]; }
                            }
                        }
                        break;

                    case "REGION_LIST":
                        g_regions = [];
                        break;
                    case "REGION":
                        g_regions.push(tok);
                        break;
                    case "MARKER_LIST_END":
                        var pos = parseFloat(playPosSeconds);
                        var previ = -1, thisi = -1, nexti = -1;
                        break;

                    case "REGION_LIST_END":

                        //assemble mrMap array : time, marker number, region start number, region end number.
                        for (var i = 0; i < g_regions.length; i++) {
                            if (g_regions[i][5] == 0) { g_regions[i][5] = 25198720; } // Give uncoloured regions a colour.
                        }
                        for (var i = 0; i < g_markers.length; i++) {
                            if (g_markers[i][4] == 0) { g_markers[i][4] = 25198720; } // Give uncoloured markers a colour.
                        }
                        var mrMapAr = [];
                        for (var i = 0; i < g_regions.length * 2; i++) {
                            mrMapAr[i] = [];
                            if (i < g_regions.length) {                             //add the region starts to the ar
                                mrMapAr[i][0] = g_regions[i][3];
                                mrMapAr[i][2] = g_regions[i][2];
                            }
                            else {                                               //add the region ends to the ar
                                mrMapAr[i][0] = g_regions[i - g_regions.length][4];
                                mrMapAr[i][3] = g_regions[i - g_regions.length][2];
                            }
                        }
                        for (var i = 0; i < g_markers.length; i++) {                //add the markers to the ar
                            mrMapAr[i + (g_regions.length * 2)] = [];
                            mrMapAr[i + (g_regions.length * 2)][0] = g_markers[i][3];
                            mrMapAr[i + (g_regions.length * 2)][1] = g_markers[i][2];
                        }

                        for (var i = 0; i < mrMapAr.length; i++) {                  //prep times for sorting
                            posToSix = parseFloat(mrMapAr[i][0]).toFixed(6);
                            mrMapAr[i][0] = parseFloat(posToSix);
                        }

                        mrMapAr.sort(function (a, b) {                           //sort into time order
                            return (a[0] === b[0] ? 0 : (a[0] < b[0] ? -1 : 1));
                        });

                        function mergeAt(idx) {
                            if (mrMapAr[i - 1][idx]) { a = mrMapAr[i - 1][idx] } else { a = 0 };
                            if (mrMapAr[i][idx]) { b = mrMapAr[i][idx] } else { b = 0 };
                            mrMapAr[i - 1][idx] = parseFloat(a) + parseFloat(b);
                        }

                        var mergeDone = 0;
                        for (var i = 1; i < mrMapAr.length; i++) {                  //merge cells if at same time, delete the duplicate
                            if (mrMapAr[i - 1] && mrMapAr[i][0] === mrMapAr[i - 1][0]) {
                                mergeAt(1); mergeAt(2); mergeAt(3);
                                mrMapAr.splice(i, 1);
                            }
                            if (i == (mrMapAr.length - 1)) { mergeDone = 1 }
                        }

                        var prevl = -1, thisl = -1, nextl = -1;
                        if (mergeDone == 1) {
                            for (var i = 0; i < mrMapAr.length; i++) {
                                var diff = (mrMapAr[i][0] - pos);
                                if (diff < 0) {
                                    if (i > prevl) { prevl = i }
                                }
                                if (diff == 0) { thisl = i };
                                if (diff > 0) {
                                    if (i > nextl) { nextl = i; break; }
                                }
                            }
                        }

                        function getValuesFromId(array, id, colourIdx) {
                            for (var i = 0, len = array.length; i < len; i++) {
                                if (array[i][2] == id) { return [id, (array[i][1]), (array[i][colourIdx])] }
                            }
                            return [0, 0, 0];
                        }

                        var nextPrevSvg = document.getElementById("nextPrev")
                        if ((pos != newPos || mrMapAr.length != newMrMapLength) && mergeDone == 1 && nextPrevSvg) {
                            var rIdxAsg = [];
                            search: for (i = 0; i < 4; i++) {                         // 4 is the maximum drawable number of regions
                                if (mrMapAr[prevl] && mrMapAr[prevl][3] >= 1) {               //region end at prev?
                                    var q = parseFloat(mrMapAr[prevl][3]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; continue search; }
                                }
                                if (mrMapAr[prevl] && mrMapAr[prevl][2] >= 1) {               //region start at prev?
                                    var q = parseFloat(mrMapAr[prevl][2]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; continue search; }
                                }
                                if (mrMapAr[thisl] && mrMapAr[thisl][3] >= 1) {               //region end at this?
                                    var q = parseFloat(mrMapAr[thisl][3]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; continue search; }
                                }
                                if (mrMapAr[thisl] && mrMapAr[thisl][2] >= 1) {               //region start at this?
                                    var q = parseFloat(mrMapAr[thisl][2]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; continue search; }
                                }
                                if (mrMapAr[nextl] && mrMapAr[nextl][3] >= 1) {               //region end at next?
                                    var q = parseFloat(mrMapAr[nextl][3]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; continue search }
                                }
                                if (mrMapAr[nextl] && mrMapAr[nextl][2] >= 1) {               //region start at next?
                                    var q = parseFloat(mrMapAr[nextl][2]);
                                    if (rIdxAsg.indexOf(q) == -1) { rIdxAsg[i] = q; }
                                }
                            }

                            function getValFromAr(array, id, idLoc, valLoc) {
                                for (var i = 0, len = array.length; i < len; i++) {
                                    if (array[i][idLoc] == id) { return array[i][valLoc]; }
                                }
                                return;
                            }

                            for (i = 1; i < 5; i++) {
                                this['r' + i + 'StalkLx'] = 45.6;
                                this['r' + i + 'StalkRx'] = 273.1;
                                if (rIdxAsg[i - 1] && rIdxAsg[i - 1] >= 0) {
                                    this['r' + i + 'Idx'] = rIdxAsg[i - 1];
                                    this['r' + i + 'Name'] = getValFromAr(g_regions, rIdxAsg[i - 1], 2, 1);
                                    this['col' + i] = getValFromAr(g_regions, rIdxAsg[i - 1], 2, 5);
                                    this['rCol' + i] = "#" + (this['col' + i] | 0x1000000).toString(16).substr(-6);
                                    if (prevl >= 0 && mrMapAr[prevl][3] == rIdxAsg[i - 1]) { this['r' + i + 'StalkRx'] = 102.5; }
                                    if (prevl >= 0 && mrMapAr[prevl][2] == rIdxAsg[i - 1]) { this['r' + i + 'StalkLx'] = 102.5; }
                                    if (thisl >= 0 && mrMapAr[thisl][2] == rIdxAsg[i - 1]) { this['r' + i + 'StalkLx'] = 159.4; }
                                    if (thisl >= 0 && mrMapAr[thisl][3] == rIdxAsg[i - 1]) { this['r' + i + 'StalkRx'] = 159.4; }
                                    if (nextl >= 0 && mrMapAr[nextl][2] == rIdxAsg[i - 1]) { this['r' + i + 'StalkLx'] = 216.2; }
                                    if (nextl >= 0 && mrMapAr[nextl][3] == rIdxAsg[i - 1]) { this['r' + i + 'StalkRx'] = 216.2; }
                                    document.getElementById('region' + i).setAttributeNS(null, "visibility", "visible");
                                    document.getElementById('r' + i + 'Rect').setAttributeNS(null, "fill", this['rCol' + i]);
                                    document.getElementById('r' + i + 'StalkL').setAttributeNS(null, "x1", this['r' + i + 'StalkLx']);
                                    document.getElementById('r' + i + 'StalkL').setAttributeNS(null, "x2", this['r' + i + 'StalkLx']);
                                    document.getElementById('r' + i + 'StalkR').setAttributeNS(null, "x1", this['r' + i + 'StalkRx']);
                                    document.getElementById('r' + i + 'StalkR').setAttributeNS(null, "x2", this['r' + i + 'StalkRx']);
                                    this['r' + i + 'RectW'] = (this['r' + i + 'StalkRx']) - (this['r' + i + 'StalkLx']);
                                    document.getElementById('r' + i + 'Rect').setAttributeNS(null, "x", this['r' + i + 'StalkLx']);
                                    document.getElementById('r' + i + 'Rect').setAttributeNS(null, "width", this['r' + i + 'RectW']);
                                    if (!this['r' + i + 'Name']) { this['r' + i + 'Name'] = this['r' + i + 'Idx'] }
                                    document.getElementById('r' + i + 'Name').textContent = this['r' + i + 'Name'];
                                    document.getElementById('r' + i + 'Name').setAttributeNS(null, "fill", lumaOffset(this['rCol' + i]));
                                    this['r' + i + 'NamePos'] = this['r' + i + 'StalkLx'] + ((this['r' + i + 'StalkRx'] - this['r' + i + 'StalkLx']) / 2);
                                    document.getElementById('r' + i + 'Name').setAttributeNS(null, "transform", "matrix(1 0 0 1 " + this['r' + i + 'NamePos'] + " 31)");
                                }
                                else { document.getElementById('region' + i).setAttributeNS(null, "visibility", "hidden"); }
                            }

                            if (mrMapAr[prevl] && mrMapAr[prevl][1] >= 1) {
                                var mPrevIdx = mrMapAr[prevl][1];
                                var mPrevName = getValFromAr(g_markers, mPrevIdx, 2, 1);
                                var mPrevCol = getValFromAr(g_markers, mPrevIdx, 2, 4);
                                mPrevCol = "#" + (mPrevCol | 0x1000000).toString(16).substr(-6);
                                document.getElementById("marker1").setAttributeNS(null, "visibility", "visible");
                                document.getElementById("marker1Bg").setAttributeNS(null, "fill", mPrevCol);
                                document.getElementById("marker1Number").textContent = mPrevIdx;
                                document.getElementById("marker1Number").setAttributeNS(null, "fill", lumaOffset(mPrevCol));
                                document.getElementById("prevMarkerName").textContent = (!mPrevName) ? ("unnamed") : (mPrevName);
                            }
                            else { document.getElementById("marker1").setAttributeNS(null, "visibility", "hidden"); }

                            if (mrMapAr[thisl] && mrMapAr[thisl][1] >= 1) {
                                var mThisIdx = mrMapAr[thisl][1];
                                var mThisName = getValFromAr(g_markers, mThisIdx, 2, 1);
                                var mThisCol = getValFromAr(g_markers, mThisIdx, 2, 4);
                                mThisCol = "#" + (mThisCol | 0x1000000).toString(16).substr(-6);
                                document.getElementById("marker2").setAttributeNS(null, "visibility", "visible");
                                document.getElementById("marker2Bg").setAttributeNS(null, "fill", mThisCol);
                                document.getElementById("marker2Number").textContent = mThisIdx;
                                document.getElementById("marker2Number").setAttributeNS(null, "fill", lumaOffset(mThisCol));
                                document.getElementById("atMarkerName").textContent = (!mThisName) ? ("unnamed") : (mThisName);
                            }
                            else { document.getElementById("marker2").setAttributeNS(null, "visibility", "hidden"); }

                            if (mrMapAr[nextl] && mrMapAr[nextl][1] >= 1) {
                                var mNextIdx = mrMapAr[nextl][1];
                                var mNextName = getValFromAr(g_markers, mNextIdx, 2, 1);
                                var mNextCol = getValFromAr(g_markers, mNextIdx, 2, 4);
                                mNextCol = "#" + (mNextCol | 0x1000000).toString(16).substr(-6);
                                document.getElementById("marker3").setAttributeNS(null, "visibility", "visible");
                                document.getElementById("marker3Bg").setAttributeNS(null, "fill", mNextCol);
                                document.getElementById("marker3Number").textContent = mNextIdx;
                                document.getElementById("marker3Number").setAttributeNS(null, "fill", lumaOffset(mNextCol));
                                document.getElementById("nextMarkerName").textContent = (!mNextName) ? ("unnamed") : (mNextName);
                            }
                            else { document.getElementById("marker3").setAttributeNS(null, "visibility", "hidden"); }

                            if (prevl >= 0) { homeIconVis = "hidden"; prevIconVis = "visible"; }
                            else {
                                homeIconVis = "visible"; prevIconVis = "hidden";
                                if (pos > 0) {
                                    document.getElementById("marker1").setAttributeNS(null, "visibility", "visible");
                                    document.getElementById("prevMarkerName").textContent = "HOME";
                                    document.getElementById("marker1Number").textContent = "H";
                                    document.getElementById("marker1Bg").setAttributeNS(null, "fill", "#1a1a1a");
                                    document.getElementById("marker1Number").setAttributeNS(null, "fill", "#A8A8A8");
                                }
                                else {
                                    document.getElementById("marker2").setAttributeNS(null, "visibility", "visible");
                                    document.getElementById("atMarkerName").textContent = "HOME";
                                    document.getElementById("marker2Number").textContent = "H";
                                    document.getElementById("marker2Bg").setAttributeNS(null, "fill", "#1a1a1a");
                                    document.getElementById("marker2Number").setAttributeNS(null, "fill", "#A8A8A8");
                                }
                            }
                            if (thisl < 0 && pos != 0) { elAttribute("dropMarker", "visibility", "visible") }
                            else { elAttribute("dropMarker", "visibility", "hidden") }
                            if (nextl >= 0) {
                                endIconVis = "hidden"; nextIconVis = "visible";
                            }
                            else {
                                document.getElementById("marker3").setAttributeNS(null, "visibility", "visible");
                                document.getElementById("nextMarkerName").textContent = "END";
                                document.getElementById("marker3Number").textContent = "E";
                                document.getElementById("marker3Bg").setAttributeNS(null, "fill", "#1a1a1a");
                                document.getElementById("marker3Number").setAttributeNS(null, "fill", "#A8A8A8");
                                endIconVis = "visible"; nextIconVis = "hidden";
                            }
                            elAttribute("iconPrev", "visibility", prevIconVis);
                            elAttribute("iconHome", "visibility", homeIconVis);
                            elAttribute("iconNext", "visibility", nextIconVis);
                            elAttribute("iconEnd", "visibility", endIconVis);

                            newPos = pos;
                            newMrMapLength = mrMapAr.length;
                        }
                        break;
                }
            }

            for (x = 0; x < nTrack; x++) {
                if ((trackHwOutCntAr[x] > 0) && (trackRcvCntAr[x] > 0)) {
                    trackIsMonitorAr[x] = 1;
                }
                else { trackIsMonitorAr[x] = 0; }
            }
            var trackSelect = document.getElementById("trackSelect");
            if (trackIsMonitorAr.length > (nTrack + 1)) {
                trackIsMonitorAr.pop();
                for (i = trackSelect.options.length; i >= 1; i--) {
                    trackSelect.remove(i);
                }
            }
            if (trackIsMonitorArOld.length > nTrack) {
                trackIsMonitorArOld.pop();
            }

            for (x = 0; x < trackIsMonitorArOld.length; x++) {
                if (trackIsMonitorArOld[x] === undefined) { trackIsMonitorArOld[x] = 0 } //so that first time round doesn't count as 'changed'
            }
            function getSum(total, num) { return total + num; }
            var trackIsMonitorArSum = trackIsMonitorAr.reduce(getSum);
            if (trackIsMonitorArOld.length > 0) { var trackIsMonitorArOldSum = trackIsMonitorArOld.reduce(getSum) }
            if (trackIsMonitorArSum != trackIsMonitorArOldSum) {
                for (i = trackSelect.options.length; i >= 1; i--) {
                    trackSelect.remove(i);
                }
            }

            if (trackSelect.options.length == 1) {
                for (x = 0; x < nTrack; x++) {
                    if (trackIsMonitorAr[x] == 1) {
                        var option = document.createElement("option");
                        option.text = trackNameAr[x];
                        trackSelect.add(option);
                    }
                    trackIsMonitorArOld[x] = trackIsMonitorAr[x];
                }
            }

            var selectChoice = trackSelect.value;
            if (selectChoice != selectChoiceOld) {
                selectChoiceIdx = trackNameAr.indexOf(selectChoice);
                selectChoiceOld = selectChoice;
            }

            for (y = 1; y < (parseInt(trackRcvCntAr[selectChoiceIdx]) + 1); y++) {
                wwr_req("GET/TRACK/" + selectChoiceIdx + "/SEND/" + (-y)); // requesting receive values of the track being displayed
            }
            wwr_req("GET/TRACK/" + selectChoiceIdx + "/SEND/" + 0); // request the first normal send, which should be the hardware send

            var last_loaded = document.getElementById("last");
            if (last_loaded == null)
                return;

            var faderContent = document.getElementsByClassName("trackRow2")[0];
            var receivesContent = document.getElementById("receives");
            var instructions = document.getElementById("instructions");
            var cloneFader = document.getElementById("trackRow2Svg").cloneNode(true);
            var cloneTrackSend = document.getElementById("trackSendSvg").cloneNode(true);
            var drawnReceives = trackRcvCntAr[selectChoiceIdx];
            var drawnReceivesDone = receivesContent.childNodes.length;
            var buttonsContent = document.getElementById("buttons");
            var tempoContent = document.getElementById("tempo");
            var controlsContent = document.getElementById("controls");
            var markerSelect = document.getElementById("markerSelect");
            if (drawnReceives < drawnReceivesDone || drawnReceives == null) {
                if (receivesContent.lastChild) { receivesContent.removeChild(receivesContent.lastChild) }
                // if (buttonsContent.lastChild) { buttonsContent.removeChild(buttonsContent.lastChild) }
                // if (document.getElementById("trackSelect_in")) { document.getElementById("trackSelect_in").hidden = true; }
            }
            if (drawnReceives > drawnReceivesDone) {
                var sendDiv = document.createElement("div");
                sendDiv.className = ("sendDiv");
                receivesContent.appendChild(sendDiv);
                sendDiv.appendChild(cloneTrackSend);
            }
            if (drawnReceives == null && faderContent.innerHTML) {
                faderContent.innerHTML = ""
                instructions.style.display = "block";
                // buttonsContent.innerHTML = "";
            }
            if (drawnReceives >= 1 && faderContent.innerHTML === "") {
                faderContent.appendChild(cloneFader);
                instructions.style.display = "none";
            }

            if (once) {
                // adding the buttons
                var button_el = document.getElementById("button").cloneNode(true);
                button_el.getElementsByClassName("track_button")[0].textContent = "FX";
                buttonsContent.appendChild(button_el);

                button_el = document.getElementById("button").cloneNode(true);
                button_el.getElementsByClassName("track_button")[0].textContent = "Mute";
                buttonsContent.appendChild(button_el);

                button_el = document.getElementById("button").cloneNode(true);
                button_el.getElementsByClassName("track_button")[0].textContent = "Rec";
                buttonsContent.appendChild(button_el);

                // tempo
                function button_up(button) {
                    return function (e) {
                        button.style.backgroundColor = "gray";
                        button.value = 0;
                        return false;
                    }
                }

                function enterBPM() {
                    wwr_req("41821;41820");
                    var curr_bpm = currBPM();
                    var new_bpm = prompt("Enter new BPM", curr_bpm);
                    if (new_bpm == null)
                        return;

                    var diff = Math.abs(new_bpm - curr_bpm);
                    var tens = Math.floor(diff / 10);
                    var ones = diff % 10;

                    var comm_tens = new_bpm < curr_bpm ? "41136" : "41135";
                    for (i = 0; i < tens; ++i) {
                        wwr_req(comm_tens);
                    }

                    var comm_ones = new_bpm < curr_bpm ? "41130" : "41129";
                    for (i = 0; i < ones; ++i) {
                        wwr_req(comm_ones);
                    }
                }

                button_el = document.getElementById("button").cloneNode(true);
                var button = button_el.getElementsByClassName("track_button")[0];
                button.textContent = "➖";
                button.disabled = false;
                button.hidden = false;
                var commands =
                    // "41820" // Move edit cursor to previous tempo or time signature change
                    "41821;41820"
                    + ";41130"; // Tempo: Decrease current project tempo 01 BPM
                button.onmousedown = mouseDownEventActivate(commands, button);
                button.onmouseup = button_up(button);
                tempoContent.appendChild(button_el);

                button_el = document.getElementById("button").cloneNode(true);
                button = button_el.getElementsByClassName("track_button")[0];
                button.textContent = "BPM";
                button.hidden = false;
                button.onclick = enterBPM;
                tempoContent.appendChild(button_el);

                button_el = document.getElementById("button").cloneNode(true);
                button = button_el.getElementsByClassName("track_button")[0];
                button.textContent = "➕";
                button.hidden = false;
                button.disabled = false;
                commands =
                    // "41820" // Move edit cursor to previous tempo or time signature change
                    "41821;41820"
                    + ";41129"; // Tempo: Increase current project tempo 01 BPM
                button.onmousedown = mouseDownEventActivate(commands, button);
                button.onmouseup = button_up(button);
                tempoContent.appendChild(button_el);

                // controls
                button_el = document.getElementById("button").cloneNode(true);
                button = button_el.getElementsByClassName("track_button")[0];
                button.textContent = "⏮️";
                button.disabled = false;
                button.hidden = false;
                button.onmousedown = mouseDownEventActivate("40172", button); // Markers: Go to previous marker/project start
                button.onmouseup = button_up(button);
                controlsContent.appendChild(button_el);

                button_el = document.getElementById("button").cloneNode(true);
                button = button_el.getElementsByClassName("track_button")[0];
                button.textContent = "▶️";
                button.disabled = false;
                button.hidden = false;
                button.onmousedown = mouseDownEventHandler("40044"); // Transport: Play/stop
                controlsContent.appendChild(button_el);

                button_el = document.getElementById("button").cloneNode(true);
                button = button_el.getElementsByClassName("track_button")[0];
                button.textContent = "⏭️";
                button.disabled = false;
                button.hidden = false;
                button.onmousedown = mouseDownEventActivate("40173", button); // Markers: Go to next marker/project end
                button.onmouseup = button_up(button);
                controlsContent.appendChild(button_el);

                button_el = document.getElementById("button").cloneNode(true);
                button = button_el.getElementsByClassName("track_button")[0];
                button.textContent = "⏪️ Marker";
                button.disabled = false;
                button.hidden = false;
                button.style.width = "50%";
                button.style.height = "60px";
                button.onmousedown = mouseDownEventActivate("41820", button); // Move edit cursor to previous tempo or time signature change
                button.onmouseup = button_up(button);
                controlsContent.appendChild(button_el);

                button_el = document.getElementById("button").cloneNode(true);
                button = button_el.getElementsByClassName("track_button")[0];
                button.textContent = "⏩️ Marker";
                button.disabled = false;
                button.hidden = false;
                button.style.width = "50%";
                button.style.height = "60px";
                button.onmousedown = mouseDownEventActivate("41821", button); // Move edit cursor to next tempo or time signature change
                button.onmouseup = button_up(button);
                controlsContent.appendChild(button_el);

                once = false;
            }


            //----------------------------------
            // Now do things based on what's been DRAWN
            //----------------------------------        

            // if (drawnReceives >= 1 && faderContent.innerHTML != "") { // on a musician's page
            // enable and fill the input selector
            var trackSelect_in = document.getElementById("trackSelect_in");
            trackSelect_in.hidden = false;
            if (trackSelect_in.options.length == 1) {
                for (x = 0; x < nTrack; x++) {
                    if (trackIsMonitorAr[x] === 0) { //!
                        var option = document.createElement("option");
                        option.text = trackNameAr[x];
                        trackSelect_in.add(option);
                    }
                }
            }

            // read the selection
            var selectChoice = trackSelect_in.value;
            if (selectChoice != selectInputOld) {
                selectInputIdx = trackNameAr.indexOf(selectChoice);
                selectInputOld = selectChoice;
            }
            if (selectInputIdx == -1) {
                for (i = 0; i < buttonsContent.childElementCount; ++i) {
                    var button = buttonsContent.childNodes[i].getElementsByClassName("track_button")[0];
                    // button.disabled = true
                    // button.style.backgroundColor = trackMutedAr[selectInputIdx] == 1 ? "tomato" : "grey";
                    button.hidden = true;
                    buttonsContent.style.height = "0px";
                }
            }
            else // activate the elements
            {
                buttonsContent.style.height = "100px";

                // FX
                var button_el = buttonsContent.childNodes[0];
                var button = button_el.getElementsByClassName("track_button")[0];
                button.hidden = false;
                if (trackHasFxAr[selectInputIdx]) {
                    button.disabled = false;

                    var commands = "40769"; // Unselect (clear selection of) all tracks/items/envelope points
                    // commands += ";SET/TRACK/" + selectInputIdx + "/SEL/-1"; // sets selection for track. if value is <0, selection is toggled
                    commands += ";" + (40938 + selectInputIdx); // Track: Select track 01
                    commands += ";41749"; // Open/close UI for FX #1 on last touched track
                    button.onmousedown = mouseDownEventActivate(commands, button);
                }
                else
                    button.disabled = true;

                // Mute
                button_el = buttonsContent.childNodes[1];
                button = button_el.getElementsByClassName("track_button")[0];
                button.hidden = false;
                button.disabled = false;
                button.style.backgroundColor = trackMutedAr[selectInputIdx] == 1 ? "tomato" : "grey";
                button.onmousedown = mouseDownEventHandler("SET/TRACK/" + selectInputIdx + "/MUTE/-1"); // sets mute for track. if value is <0, mute is toggled

                // rec
                button_el = buttonsContent.childNodes[2];
                button = button_el.getElementsByClassName("track_button")[0];
                button.hidden = false;
                button.disabled = false;
                button.textContent = "Rec";
                button.style.backgroundColor = trackRecAr[selectInputIdx] == 1 ? "tomato" : "grey";
                button.onmousedown = mouseDownEventHandler("SET/TRACK/" + selectInputIdx + "/RECARM/-1"); // sets record arm enabled for track. if value is <0, record arm enabled is toggled
            }

            // enable and fill the marker selector
            markerSelect.hidden = false;
            if (markerSelect.options.length == 1) {
                for (x = 0; x < MarkersAr.length; x++) {
                    var option = document.createElement("option");
                    [name, id, position, color] = MarkersAr[x];
                    option.text = id + ". " + name;
                    option.style.color = color == '' ? "#A9ABAB" : color;
                    markerSelect.add(option);
                }
            }
            // }

            var button_el = tempoContent.childNodes[1];
            if (button_el) {
                var button = button_el.getElementsByClassName("track_button")[0];
                var bpm_str = "";
                if (playstate & 1 && (pos_sec > pos_sec_prev)) {
                    bpm_str += currBPM() + ' ';
                    button.disabled = false;
                }
                else
                    button.disabled = true;
                button.textContent = bpm_str + "BPM";
            }

            button_el = controlsContent.childNodes[1];
            if (button_el) {
                var button = button_el.getElementsByClassName("track_button")[0];
                if (playstate & 1) {
                    button.textContent = "⏹";
                    button.style.backgroundColor = "tomato";
                }
                else {
                    button.textContent = "▶️";
                    button.style.backgroundColor = "green";
                }
            }

            if (markerSelect.options.length > 1) {
                var found = false;
                var newMarker = currMarker;
                for (i = MarkersAr.length - 1; i >= 0; --i) {
                    [name, id, position, color] = MarkersAr[i];
                    if (parseFloat(position) < parseFloat(pos_sec) + 0.0001) {
                        newMarker = i;
                        found = true;
                        break;
                    }
                }
                if (!found)
                    newMarker = -1;

                if (newMarker != currMarker) {
                    markerSelect.selectedIndex = newMarker + 1;
                    var color = markerSelect.children[newMarker + 1].style.color;
                    markerSelect.style.color = color == '' ? markerSelect.children[0].style.color : color;
                    currMarker = newMarker;
                }

                // read the selection
                var selectChoice = markerSelect.selectedIndex;
                if (selectChoice != selectMarkerOld) {
                    selectMarkerIdx = selectChoice - 1;
                    selectMarkerOld = selectChoice;

                    if (selectMarkerIdx == -1) {
                        wwr_req("SET/POS/0");
                        markerSelect.style.color = markerSelect.children[0].style.color;
                    }
                    else {
                        wwr_req("SET/POS_STR/m" + MarkersAr[selectMarkerIdx][1]);
                        var color = markerSelect.children[selectMarkerIdx + 1].style.color;
                        markerSelect.style.color = color == '' ? markerSelect.children[0].style.color : color;
                    }
                    currMarker = selectMarkerIdx;
                }
            }

            var trackRow2Content = document.getElementById("trackRow2Svg");
            if (trackRow2Content) {
                var volThumb = trackRow2Content.getElementsByClassName("fader")[0];
                volFaderConect(trackRow2Content, volThumb);
                volThumb.volSetting = (Math.pow(hardVol, 1 / 4) * 194.68);
                if (volThumb.volSetting) {
                    var vteMove = "translate(" + volThumb.volSetting + " 0)"
                    if (mouseDown != 1) { volThumb.setAttributeNS(null, "transform", vteMove); }
                }
            }

            for (x = 0; x < drawnReceivesDone; x++) { //remember not to spam the DOM like a twat
                var thisChild = receivesContent.childNodes[x];
                if (thisChild && receiveIdxAr[x] && receiveVolAr[x]) {
                    thisChild.id = x + 1;
                    thisName = trackNameAr[receiveIdxAr[x]];
                    thisVol = mkvolstr(receiveVolAr[x]);
                    var thisCol = ("#" + (trackColoursAr[receiveIdxAr[x]] | 0x1000000).toString(16).substr(-6));
                    if (thisChild) {
                        sendTitleText = thisChild.getElementsByClassName("sendTitleText")[0]
                        sDbText = thisChild.getElementsByClassName("sDbText")[0];
                    }
                    if (sendTitleText && sendTitleText.textContent != thisName) sendTitleText.textContent = thisName;
                    if (sDbText && sDbText.Content != thisVol) sDbText.textContent = thisVol;
                    var sendLine = thisChild.getElementsByClassName("sendLine")[0];
                    sSetting = (Math.pow(receiveVolAr[x], 1 / 4) * 154) + 27;
                    if (mouseDown != 1) { sendLine.setAttributeNS(null, "x2", sSetting); }
                    var sendThumb = thisChild.getElementsByClassName("sendThumb")[0];
                    if (mouseDown != 1) { sendThumb.setAttributeNS(null, "cx", sSetting); }

                    sendConect(thisChild, sendThumb);

                    var sendThumbColour = thisChild.getAttribute("style")
                    var defaultColour = "#000000";
                    if (thisCol != defaultColour) {
                        if (sendThumbColour != thisCol) {
                            sendThumb.setAttributeNS(null, "fill", thisCol);
                            sendTitleText.setAttributeNS(null, "fill", thisCol);
                        }
                    }
                    else {
                        sendThumb.setAttributeNS(null, "fill", "#808080");
                        sendTitleText.setAttributeNS(null, "fill", "#A3A3A3");
                    }

                    var sendMuteButton = thisChild.getElementsByClassName("send_mute")[0];
                    sendMuteButton.onmousedown = mouseDownEventHandler("SET/TRACK/" + selectChoiceIdx + "/SEND/" + (-x - 1) + "/MUTE/-1");
                    var sendMuteOff = thisChild.getElementsByClassName("send_mute_off")[0];
                    var sendMuteOn = thisChild.getElementsByClassName("send_mute_on")[0];
                    if (receiveMuteAr[x] == 1) {
                        sendMuteOff.style.visibility = "hidden";
                        sendMuteOn.style.visibility = "visible";
                    }
                    else {
                        sendMuteOff.style.visibility = "visible";
                        sendMuteOn.style.visibility = "hidden";
                    }
                }
            }
        }

        function init() {
            if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
                for (let l = 0; l < document.styleSheets.length; l++) {
                    let ss = document.styleSheets[l];
                    if (ss.cssRules) for (let i = 0; i < ss.cssRules.length; i++) {
                        let st = ss.cssRules[i].selectorText;
                        if (st != undefined && st.startsWith(".button")) ss.removeRule(i--);
                    }
                }
            }
        }    
    </script>
</head>

<body onLoad="init()">

    <div id="colWrap">

        <!--results : <span id="_results" style="font-size : 0.7em"></span><br><br>-->
    </div>
    <select id="trackSelect">
        <option>Select your monitor track...</option>
    </select><br><br>

    <div id="instructions">
        Each performer requires their own monitor track to be created in REAPER. <br><br>
        Set it to receive sends from all the tracks you want to monitor.<br><br>
        Give it a hardware send to the performer's output in its first send slot.<br><br>
        Don't forget - you'll probably want to disable its Master Send.<br><br>
    </div>

    <div class="trackRow2"></div>

    <div id="receives"></div>

    <hr class="rounded">

    <select id="trackSelect_in">
        <option>Select your input track...</option>
    </select><br><br>

    <div id="buttons"></div>
    <hr class="rounded">

    <!-- <div id="marker_name"></div> -->
    <select id="markerSelect">
        <option>Project start</option>
    </select><br><br>
    <div id="controls" style="height: 100px;"></div><br><br><br>
    <!-- <hr class="rounded"> -->

    <div id="tempo" style="height: 100px;"></div>

    <div>
        <svg id="nextPrev" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px" y="0px" width="100%" height="100%" viewBox="0 0 318.9 87.8" xml:space="preserve">
            <polygon id="markerSecBg" fill="#262626" points="164.3,12.5 159,17.8 153.8,12.5 70.4,12.5 70.4,79.2 153.8,79.2 159,74 
        164.3,79.2 248.3,79.2 248.3,12.5 " />
            <rect id="markerStrip" x="70.4" y="50.4" fill="#2D2D2D" width="177.9" height="15" />
            <rect id="regionStrip" x="70.4" y="20.2" fill="#2D2D2D" width="177.9" height="15" />
            <path id="locTriangles" fill="#666666"
                d="M152.4,87.8l6.6-6.6l6.6,6.6H152.4z M152.4,4l6.6,6.6l6.6-6.6H152.4z" />
            <style type="text/css">
                .st0 {
                    fill: none;
                    stroke: #808080;
                    stroke-miterlimit: 10;
                }

                .st3 {
                    font-family: 'Open Sans';
                    text-anchor: middle;
                }

                .st4 {
                    font-size: 10px;
                }
            </style>
            <g id="region1" visibility="hidden">
                <line id="r1StalkL" class="st0" x1="45.6" y1="30.7" x2="45.6" y2="73.6" />
                <line id="r1StalkR" class="st0" x1="102.5" y1="30.7" x2="102.5" y2="73.6" />
                <rect id="r1Rect" x="45.6" y="20.2" rx="3" ry="3" stroke="#808080" width="56.9" height="15.1" />
                <text id="r1Name" transform="matrix(1 0 0 1 74.5 31)" class="st3 st4"></text>
            </g>
            <g id="region2" visibility="hidden">
                <line id="r2StalkL" class="st0" x1="45.6" y1="30.7" x2="45.6" y2="73.6" />
                <line id="r2StalkR" class="st0" x1="102.5" y1="30.7" x2="102.5" y2="73.6" />
                <rect id="r2Rect" x="45.6" y="20.2" rx="3" ry="3" stroke="#808080" width="56.9" height="15.1" />
                <text id="r2Name" transform="matrix(1 0 0 1 74.5 31)" class="st3 st4"></text>
            </g>
            <g id="region3" visibility="hidden">
                <line id="r3StalkL" class="st0" x1="45.6" y1="30.7" x2="45.6" y2="73.6" />
                <line id="r3StalkR" class="st0" x1="102.5" y1="30.7" x2="102.5" y2="73.6" />
                <rect id="r3Rect" x="45.6" y="20.2" rx="3" ry="3" stroke="#808080" width="56.9" height="15.1" />
                <text id="r3Name" transform="matrix(1 0 0 1 74.5 31)" class="st3 st4"></text>
            </g>
            <g id="region4" visibility="hidden">
                <line id="r4StalkL" class="st0" x1="45.6" y1="30.7" x2="45.6" y2="73.6" />
                <line id="r4StalkR" class="st0" x1="102.5" y1="30.7" x2="102.5" y2="73.6" />
                <rect id="r4Rect" x="45.6" y="20.2" rx="3" ry="3" stroke="#808080" width="56.9" height="15.1" />
                <text id="r4Name" transform="matrix(1 0 0 1 74.5 31)" class="st3 st4"></text>
            </g>

            <g id="marker1" visibility="hidden">
                <line id="markerStalk" fill="none" stroke="#808080" stroke-miterlimit="10" x1="102.5" y1="59.7"
                    x2="102.5" y2="73.6" />
                <rect id="marker1Bg" x="95" y="50.4" rx="3" ry="3" stroke="#808080" stroke-miterlimit="10" width="15"
                    height="15" />
                <text id="marker1Number" transform="matrix(1 0 0 1 102.5 61.5)" fill="#A8A8A8" font-family="'Open Sans'"
                    text-anchor="middle" font-size="10px"></text>
                <g>
                    <defs>
                        <rect id="npClip1" x="74.1" y="35.8" width="56.8" height="14.6" />
                    </defs>
                    <clipPath id="npClip2">
                        <use xlink:href="#npClip1" overflow="visible" />
                    </clipPath>
                    <g clip-path="url(#npClip2)">
                        <text id="prevMarkerName" transform="matrix(1 0 0 1 102.5 46.6)" fill="#A8A8A8"
                            font-family="'Open Sans'" text-anchor="middle" font-size="10px"></text>
                    </g>
                </g>
            </g>
            <g id="marker2" visibility="hidden">
                <line id="markerStalk_1_" fill="none" stroke="#808080" stroke-miterlimit="10" x1="159.3" y1="59.7"
                    x2="159.3" y2="73.6" />
                <rect id="marker2Bg" x="151.8" y="50.4" rx="3" ry="3" stroke="#808080" stroke-miterlimit="10" width="15"
                    height="15" />
                <text id="marker2Number" transform="matrix(1 0 0 1 159.5 61.5)" fill="#A8A8A8" font-family="'Open Sans'"
                    text-anchor="middle" font-size="10px"></text>
                <g>
                    <defs>
                        <rect id="npClip3" x="130.9" y="35.8" width="56.8" height="14.6" />
                    </defs>
                    <clipPath id="npClip4">
                        <use xlink:href="#npClip3" overflow="visible" />
                    </clipPath>
                    <g clip-path="url(#npClip4)">
                        <text id="atMarkerName" transform="matrix(1 0 0 1 159.5 46.6)" fill="#A8A8A8"
                            font-family="'Open Sans'" text-anchor="middle" font-size="10px"></text>
                    </g>
                </g>
            </g>
            <g id="marker3" visibility="hidden">
                <line id="markerStalk_2_" fill="none" stroke="#808080" stroke-miterlimit="10" x1="216.1" y1="59.7"
                    x2="216.1" y2="73.6" />
                <rect id="marker3Bg" x="208.6" y="50.4" rx="3" ry="3" stroke="#808080" stroke-miterlimit="10" width="15"
                    height="15" />
                <text id="marker3Number" transform="matrix(1 0 0 1 216 61.5)" fill="#A8A8A8" font-family="'Open Sans'"
                    text-anchor="middle" font-size="10px"></text>
                <g>
                    <defs>
                        <rect id="npClip5" x="187.7" y="35.8" width="56.8" height="14.6" />
                    </defs>
                    <clipPath id="npClip6">
                        <use xlink:href="#npClip5" overflow="visible" />
                    </clipPath>
                    <g clip-path="url(#npClip6)">
                        <text id="nextMarkerName" transform="matrix(1 0 0 1 216 46.6)" fill="#A8A8A8"
                            font-family="'Open Sans'" text-anchor="middle" font-size="10px"></text>
                    </g>
                </g>
            </g>
            <g id=nextButton class="button" onClick="wwr_req(40173)">
                <path class="shadow" opacity="0.15" d="M248.3,83.5h29.6c17.8,0,32.3-14.4,32.3-32.3v-5.6h-64.6v35
            C245.6,82.4,246.8,83.5,248.3,83.5z" />
                <path fill="#1A1A1A" d="M248.3,12.5H278c18.4,0,33.4,15,33.4,33.4s-15,33.4-33.4,33.4h-29.7c-2,0-3.7-1.6-3.7-3.7V16.2
            C244.6,14.1,246.3,12.5,248.3,12.5L248.3,12.5z" />

                <linearGradient id="mrg1" gradientUnits="userSpaceOnUse" x1="-1856.4718" y1="405.6207" x2="-1856.4718"
                    y2="469.644" gradientTransform="matrix(-1 0 0 -1 -1578.4503 483.5079)">
                    <stop offset="0" style="stop-color:#262626" />
                    <stop offset="1" style="stop-color:#404040" />
                </linearGradient>
                <path fill="url(#mrg1)" d="M278,77.9c17.7,0,32-14.3,32-32s-14.3-32-32-32h-29.7c-1.2,0-2.3,1.1-2.3,2.3v59.4
            c0,1.4,1.1,2.3,2.3,2.3H278z" />
                <path opacity="5.000000e-02" d="M310.2,45.7H246v29.4c0,1.5,1.2,2.7,2.7,2.7h29.4
            C295.9,77.9,310.2,63.4,310.2,45.7L310.2,45.7z" />
                <path id="iconEnd" visibility="hidden" fill="#808080"
                    d="M279.4,46l-17.4-11.3v22.6L279.4,46z M281.4,34.7h5v22.6h-5V34.7z" />
                <path id="iconNext" fill="#808080" d="M279.4,46l-17.4-11.3v22.6L279.4,46z M278.7,34.7h10.4l-5.2,5L278.7,34.7z
             M281.4,42.2h5v15h-5V42.2z" />
                <path class="mouseover" visibility="hidden" opacity="0.05" fill="#FFFFFF" d="M278,77.9c17.7,0,32-14.3,32-32s-14.3-32-32-32h-29.7
            c-1.2,0-2.3,1.1-2.3,2.3v59.4c0,1.4,1.1,2.3,2.3,2.3H278z" />
            </g>
            <g id=prevButton class="button" onClick="wwr_req(40172)">
                <path class="shadow" opacity="0.15" d="M70.4,83.5H40.8C23,83.5,8.5,69,8.5,51.2v-5.6h64.6v35
            C73.1,82.4,71.9,83.5,70.4,83.5z" />
                <path fill="#1A1A1A" d="M70.4,12.5H40.7c-18.4,0-33.4,15-33.4,33.4s15,33.4,33.4,33.4h29.7c2,0,3.7-1.6,3.7-3.7V16.2
            C74.1,14.1,72.4,12.5,70.4,12.5L70.4,12.5z" />

                <linearGradient id="mrg2" gradientUnits="userSpaceOnUse" x1="-436.7075" y1="405.6207" x2="-436.7075"
                    y2="469.644" gradientTransform="matrix(1 0 0 -1 477.3987 483.5079)">
                    <stop offset="0" style="stop-color:#262626" />
                    <stop offset="1" style="stop-color:#404040" />
                </linearGradient>
                <path fill="url(#mrg2)" d="M40.7,77.9c-17.7,0-32-14.3-32-32s14.3-32,32-32h29.7c1.2,0,2.3,1.1,2.3,2.3v59.4
            c0,1.4-1.1,2.3-2.3,2.3H40.7z" />
                <path opacity="5.000000e-02" d="M8.5,45.7h64.2v29.4c0,1.5-1.2,2.7-2.7,2.7H40.6
            C22.8,77.9,8.5,63.4,8.5,45.7L8.5,45.7z" />
                <path id="iconHome" visibility="hidden" fill="#808080"
                    d="M39.3,46l17.4-11.3v22.6L39.3,46z M37.3,34.7h-5v22.6h5V34.7z" />
                <path id="iconPrev" fill="#808080" d="M39.3,46l17.4-11.3v22.6L39.3,46z M40,34.7H29.7l5.2,5L40,34.7z M37.3,42.2h-5v15
            h5V42.2z" />
                <path class="mouseover" visibility="hidden" opacity="0.05" fill="#FFFFFF" d="M40.7,77.9c-17.7,0-32-14.3-32-32s14.3-32,32-32h29.7
            c1.2,0,2.3,1.1,2.3,2.3v59.4c0,1.4-1.1,2.3-2.3,2.3H40.7z" />
            </g>
            <g id="dropMarker" class="button" visibility="hidden" onClick="wwr_req(40157)">
                <rect x="145.2" y="40.7" fill-opacity="0.25" stroke="#808080" stroke-dasharray="2, 4"
                    stroke-miterlimit="10" rx="3" ry="3" width="28.4" height="28.4" />
                <path id="+" fill="none" stroke="#808080" stroke-width="3" stroke-miterlimit="10"
                    d="M159.4,63.3V46.5 M151.1,54.9h16.7" />
                <rect id="dropMarkerHitbox" x="131.2" y="35.2" fill="none" width="56.6" height="44" />
                <rect class="mouseover" visibility="hidden" x="145.2" y="40.7" opacity="0.15" fill="#FFFFFF"
                    width="28.4" height="28.4" />
            </g>
        </svg>

    </div>

    <div id="transport_r2">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
            width="100%" height="100%" viewBox="0 0 303.6 107.6" xml:space="preserve">
            <circle id="playLineBg" fill="#222625" cx="151.8" cy="52.4" r="52.3" />
            <circle id="playLine" fill="none" stroke-dasharray="50" stroke-dashoffset="10" stroke="#00FE95"
                stroke-width="6" stroke-miterlimit="10" cx="151.8" cy="52.4" r="48" />

            <g id="play" class="button" onClick="wwr_req(1007)">
                <g id=playButtonOn visibility="hidden">
                    <path fill="#00FF99"
                        d="M151.8,97c-24.6,0-44.6-20-44.6-44.6s20-44.6,44.6-44.6s44.6,20,44.6,44.6S176.4,97,151.8,97z" />
                    <path fill="#1A1A1A" d="M151.8,8.4c24.3,0,44,19.7,44,44s-19.7,44-44,44s-44-19.7-44-44S127.5,8.4,151.8,8.4 M151.8,7.2
                    c-25,0-45.2,20.2-45.2,45.2s20.2,45.2,45.2,45.2S197,77.4,197,52.4S176.8,7.2,151.8,7.2L151.8,7.2z" />

                    <linearGradient id="pograd" gradientUnits="userSpaceOnUse" x1="151.7784" y1="-1823.5439"
                        x2="151.7784" y2="-1779.5526" gradientTransform="matrix(1 0 0 -1 0 -1771.1405)">
                        <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0.25" />
                        <stop offset="1" style="stop-color:#FFFFFF" />
                    </linearGradient>
                    <path opacity="0.15" fill="url(#pograd)" d="M195.8,52.4h-88l0,0c0-24.3,19.7-44,44-44l0,0
                    C176.2,8.4,195.8,28.1,195.8,52.4L195.8,52.4z" />
                    <polygon fill="#FFFFFF" points="139.6,67.9 139.6,37.1 170.4,52.4 		" />
                    <path class="mouseover" visibility="hidden" opacity="0.2" fill="#FFFFFF" d="M151.8,97c-24.6,0-44.6-20-44.6-44.6
                    s20-44.6,44.6-44.6s44.6,20,44.6,44.6S176.4,97,151.8,97z" />
                </g>
                <g id=playButtonOff visibility="visible">
                    <circle class="shadow" opacity="0.15" cx="151.8" cy="62.4" r="45.2" />

                    <linearGradient id="pffgrad" gradientUnits="userSpaceOnUse" x1="151.7784" y1="1033.0232"
                        x2="151.7784" y2="943.7836" gradientTransform="matrix(1 0 0 1 0 -936)">
                        <stop offset="0" style="stop-color:#697373" />
                        <stop offset="1" style="stop-color:#B0BBBB" />
                    </linearGradient>
                    <path fill="url(#pffgrad)"
                        d="M151.8,97c-24.6,0-44.6-20-44.6-44.6s20-44.6,44.6-44.6s44.6,20,44.6,44.6S176.4,97,151.8,97z" />
                    <path fill="#1A1A1A" d="M151.8,8.4c24.3,0,44,19.7,44,44s-19.7,44-44,44s-44-19.7-44-44S127.5,8.4,151.8,8.4 M151.8,7.2
                    c-25,0-45.2,20.2-45.2,45.2s20.2,45.2,45.2,45.2S197,77.4,197,52.4S176.8,7.2,151.8,7.2L151.8,7.2z" />

                    <linearGradient id="pffgrad2" gradientUnits="userSpaceOnUse" x1="151.7784" y1="-1823.5439"
                        x2="151.7784" y2="-1779.5526" gradientTransform="matrix(1 0 0 -1 0 -1771.1405)">
                        <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0.25" />
                        <stop offset="1" style="stop-color:#FFFFFF" />
                    </linearGradient>
                    <path opacity="0.15" fill="url(#pffgrad2)" d="M195.8,52.4h-88l0,0c0-24.3,19.7-44,44-44l0,0
                    C176.2,8.4,195.8,28.1,195.8,52.4L195.8,52.4z" />
                    <polygon fill="#1A1A1A" points="139.6,67.9 139.6,37.1 170.4,52.4 " />
                    <path class="mouseover" visibility="hidden" opacity="0.2" fill="#FFFFFF" d="M151.8,97c-24.6,0-44.6-20-44.6-44.6
                    s20-44.6,44.6-44.6s44.6,20,44.6,44.6S176.4,97,151.8,97z" />
                </g>
            </g>
            <g id="stopButton" class="button" onClick="wwr_req(40667)">
                <path class="shadow" opacity="0.15" d="M8.4,58.7c0,0.6,0,1.1,0,1.7v0c0,25.9,21,47,47,47h37
                c5.6,0,11-2.1,15.1-5.9c-10-10.8-16.1-25.2-16.1-41.1c0-0.6,0-1.1,0-1.7H8.4z" />
                <g>
                    <linearGradient id="stgrad" gradientUnits="userSpaceOnUse" x1="58.0022" y1="4.8047" x2="58.0022"
                        y2="100.002">
                        <stop offset="0" style="stop-color:#404040" />
                        <stop offset="1" style="stop-color:#262626" />
                    </linearGradient>
                    <path fill="url(#stgrad)"
                        d="M55.3,100C29.1,100,7.7,78.6,7.7,52.4S29.1,4.8,55.3,4.8h36.9c5.8,0,11.4,2.2,15.6,6.1l0.5,0.4
                    l-0.4,0.5C97.6,22.9,91.9,37.3,91.9,52.4c0,15.1,5.7,29.6,16,40.7l0.4,0.5l-0.5,0.4c-4.3,3.9-9.8,6-15.6,6H55.3z" />
                    <path fill="#1A1A1A" d="M92.2,5.4c5.6,0,11.1,2.1,15.2,5.9c-10,10.8-16.1,25.2-16.1,41.1c0,15.9,6.1,30.3,16.1,41.1
                    c-4.1,3.8-9.5,5.9-15.1,5.9h-37c-25.9,0-47-21-47-47v0c0-25.9,21-47,47-47H92.2 M92.2,4.2H55.3C28.7,4.2,7.1,25.8,7.1,52.4
                    c0,26.6,21.6,48.2,48.2,48.2h37c5.9,0,11.6-2.2,16-6.2l0.9-0.8l-0.9-0.9c-10.2-11-15.8-25.3-15.8-40.2c0-14.9,5.6-29.2,15.8-40.2
                    l0.9-0.9l-0.9-0.8C103.8,6.4,98.1,4.2,92.2,4.2L92.2,4.2z" />
                </g>
                <rect x="39.9" y="34.3" fill="#808080" width="32.9" height="32.9" />
                <linearGradient id="stgrad2" gradientUnits="userSpaceOnUse" x1="57.8796" y1="50.7389" x2="57.8796"
                    y2="5.4297">
                    <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0.25" />
                    <stop offset="1" style="stop-color:#FFFFFF" />
                </linearGradient>
                <path opacity="5.000000e-02" fill="url(#stgrad2)" d="M55.3,5.4C29.9,5.4,9.3,25.6,8.4,50.7h82.9c0.4-15.2,6.4-29,16.1-39.4l0,0
                c-4.1-3.8-9.5-5.9-15.1-5.9H55.3z" />
                <path opacity="5.000000e-02" d="M8.4,50.7c0,0.6,0,1.1,0,1.7v0c0,25.9,21,47,47,47h37c5.6,0,11-2.1,15.1-5.9
                c-10-10.8-16.1-25.2-16.1-41.1c0-0.6,0-1.1,0-1.7H8.4z" />
                <path class="mouseover" visibility="hidden" opacity="0.05" fill="#FFFFFF" d="M107.4,93.5c-10-10.8-16.1-25.2-16.1-41.1
                c0-15.9,6.1-30.3,16.1-41.1c-4.2-3.8-9.6-5.9-15.2-5.9H55.3c-25.9,0-47,21-47,47v0c0,25.9,21,47,47,47h37
                C97.9,99.4,103.3,97.3,107.4,93.5z" />
            </g>
            <g id="pause" class="button" onClick="wwr_req(1008)">
                <g id="pauseButtonOn" visibility="hidden">
                    <path class="shadow" opacity="0.15" d="M295.2,58.7c0,0.6,0,1.1,0,1.7v0c0,25.9-21,47-47,47h-37
                    c-5.6,0-11-2.1-15.1-5.9c10-10.8,16.1-25.2,16.1-41.1c0-0.6,0-1.1,0-1.7H295.2z" />
                    <path fill="#7DBBBB" stroke="#000000" stroke-width="1.25" stroke-miterlimit="10" d="M196.2,93.5c10-10.8,16.1-25.2,16.1-41.1
                    c0-15.9-6.1-30.3-16.1-41.1c4.2-3.8,9.6-5.9,15.2-5.9h36.9c25.9,0,47,21,47,47v0c0,25.9-21,47-47,47h-37
                    C205.7,99.4,200.3,97.3,196.2,93.5z" />
                    <path fill="#FFFFFF" d="M230.8,67.2h11V34.3h-11V67.2z M252.6,34.3v32.9h11V34.3H252.6z" />
                    <path class="mouseover" visibility="hidden" opacity="0.2" fill="#FFFFFF" d="M196.2,93.5c10-10.8,16.1-25.2,16.1-41.1
                    c0-15.9-6.1-30.3-16.1-41.1c4.2-3.8,9.6-5.9,15.2-5.9h36.9c25.9,0,47,21,47,47v0c0,25.9-21,47-47,47h-37
                    C205.7,99.4,200.3,97.3,196.2,93.5z" />
                </g>
                <g id="pauseButtonOff" visibility="visible">
                    <path class="shadow" opacity="0.15" d="M295.2,58.7c0,0.6,0,1.1,0,1.7v0c0,25.9-21,47-47,47h-37
                    c-5.6,0-11-2.1-15.1-5.9c10-10.8,16.1-25.2,16.1-41.1c0-0.6,0-1.1,0-1.7H295.2z" />
                    <g>
                        <linearGradient id="pfgrad" gradientUnits="userSpaceOnUse" x1="269.153" y1="4.8047" x2="269.153"
                            y2="100.002" gradientTransform="matrix(-1 0 0 1 514.7297 0)">
                            <stop offset="0" style="stop-color:#404040" />
                            <stop offset="1" style="stop-color:#262626" />
                        </linearGradient>
                        <path fill="url(#pfgrad)" d="M211.3,100c-5.8,0-11.3-2.1-15.6-6l-0.5-0.4l0.4-0.5c10.3-11.1,16-25.6,16-40.7
                        c0-15.1-5.7-29.5-15.9-40.6l-0.4-0.5l0.5-0.4c4.3-3.9,9.8-6.1,15.6-6.1h36.9c26.2,0,47.6,21.4,47.6,47.6S274.5,100,248.3,100
                        H211.3z" />
                        <path fill="#1A1A1A"
                            d="M248.3,5.4c25.9,0,47,21,47,47v0c0,25.9-21,47-47,47h-37c-5.6,0-11-2.1-15.1-5.9
                        c10-10.8,16.1-25.2,16.1-41.1c0-15.9-6.1-30.3-16.1-41.1c4.2-3.8,9.6-5.9,15.2-5.9H248.3 M248.3,4.2h-36.9
                        c-6,0-11.7,2.2-16.1,6.2l-0.9,0.8l0.9,0.9c10.2,11,15.8,25.3,15.8,40.2c0,15-5.6,29.2-15.8,40.2l-0.9,0.9l0.9,0.8
                        c4.4,4,10.1,6.2,16,6.2h37c26.6,0,48.2-21.6,48.2-48.2C296.5,25.8,274.9,4.2,248.3,4.2L248.3,4.2z" />
                    </g>
                    <path fill="#808080" d="M230.8,67.2h11V34.3h-11V67.2z M252.6,34.3v32.9h11V34.3H252.6z" />
                    <linearGradient id="pfgrad2" gradientUnits="userSpaceOnUse" x1="269.0302" y1="50.7389" x2="269.0302"
                        y2="5.4297" gradientTransform="matrix(-1 0 0 1 514.7297 0)">
                        <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0.25" />
                        <stop offset="1" style="stop-color:#FFFFFF" />
                    </linearGradient>
                    <path opacity="5.000000e-02" fill="url(#pfgrad2)" d="M248.3,5.4c25.4,0,46.1,20.1,46.9,45.3h-82.9c-0.4-15.2-6.4-29-16.1-39.4
                    l0,0c4.1-3.8,9.5-5.9,15.1-5.9H248.3z" />
                    <path opacity="5.000000e-02" d="M295.2,50.7c0,0.6,0,1.1,0,1.7v0c0,25.9-21,47-47,47h-37c-5.6,0-11-2.1-15.1-5.9
                    c10-10.8,16.1-25.2,16.1-41.1c0-0.6,0-1.1,0-1.7H295.2z" />
                    <path class="mouseover" visibility="hidden" opacity="0.05" fill="#FFFFFF" d="M196.2,93.5c10-10.8,16.1-25.2,16.1-41.1
                    c0-15.9-6.1-30.3-16.1-41.1c4.2-3.8,9.6-5.9,15.2-5.9h36.9c25.9,0,47,21,47,47v0c0,25.9-21,47-47,47h-37
                    C205.7,99.4,200.3,97.3,196.2,93.5z" />
                </g>
            </g>
        </svg>
    </div>

    <div id="backLoad" style="display:none">

        <element id=trackRow2Svg>
            <svg version="1.1" class="faderSvg" display="block" xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%"
                viewBox="0 1 320 47" xml:space="preserve">
                <rect x="0" fill="#333333" width="320" height="36" />
                <rect id="fader_track" x="23" y="16.7" transform="matrix(-1 -1.224647e-16 1.224647e-16 -1 320 37.3333)"
                    opacity="0.5" fill="#1A1A1A" width="274" height="4" />
                <g class="fader">
                    <g>
                        <linearGradient id="fGrad1" gradientUnits="userSpaceOnUse" x1="245.0833" y1="-114.0833"
                            x2="245.0833" y2="-106.0833"
                            gradientTransform="matrix(6.123234e-17 -1 -1 -6.123234e-17 -68.0833 263.0833)">
                            <stop offset="0" style="stop-color:#212121" />
                            <stop offset="1" style="stop-color:#949494" />
                        </linearGradient>
                        <rect x="38" y="0.5" fill="url(#fGrad1)" width="8" height="35" />

                        <linearGradient id="fGrad2" gradientUnits="userSpaceOnUse" x1="245.0833" y1="-106.0833"
                            x2="245.0833" y2="-92.0833"
                            gradientTransform="matrix(6.123234e-17 -1 -1 -6.123234e-17 -68.0833 263.0833)">
                            <stop offset="0" style="stop-color:#FFFFFF" />
                            <stop offset="0.9991" style="stop-color:#7A7A7A" />
                        </linearGradient>
                        <path fill="url(#fGrad2)" d="M26,0.5h12v35H26c-1.1,0-2-0.9-2-2v-31C24,1.4,24.9,0.5,26,0.5z" />

                        <linearGradient id="fGrad3" gradientUnits="userSpaceOnUse" x1="245.0833" y1="-91.0833"
                            x2="245.0833" y2="-77.0833"
                            gradientTransform="matrix(6.123234e-17 -1 -1 -6.123234e-17 -68.0833 263.0833)">

                            <stop offset="0" style="stop-color:#9C9C9C" />
                            <stop offset="1" style="stop-color:#4D4D4D" />
                        </linearGradient>
                        <path fill="url(#fGrad3)" d="M21,35.5c1.1,0,2-0.9,2-2v-31c0-1.1-0.9-2-2-2H9v35H21z" />

                        <linearGradient id="fGrad4" gradientUnits="userSpaceOnUse" x1="245.0833" y1="-77.0833"
                            x2="245.0833" y2="-69.0833"
                            gradientTransform="matrix(6.123234e-17 -1 -1 -6.123234e-17 -68.0833 263.0833)">
                            <stop offset="0" style="stop-color:#FFFFFF" />
                            <stop offset="0.1231" style="stop-color:#F2F2F2" />
                            <stop offset="0.3517" style="stop-color:#CFCFCF" />
                            <stop offset="0.6607" style="stop-color:#979797" />
                            <stop offset="1" style="stop-color:#525252" />
                        </linearGradient>
                        <rect x="1" y="0.5" fill="url(#fGrad4)" width="8" height="35" />
                    </g>
                    <path id="outline_1_" d="M1,0.5h20c1.1,0,2,0.9,2,2v31c0,1.1-0.9,2-2,2H1V0.5 M24,2.5c0-1.1,0.9-2,2-2h20v35H26c-1.1,0-2-0.9-2-2
                V2.5 M0.5,0v36H21c1.4,0,2.5-1.1,2.5-2.5c0,1.4,1.1,2.5,2.5,2.5h20.5V0H26c-1.4,0-2.5,1.1-2.5,2.5C23.5,1.1,22.4,0,21,0H0.5L0.5,0z
                " />
                    <path opacity="0.1" fill="#FFFFFF" d="M2,1.5h19c0.6,0,1,0.4,1,1v31c0,0.6-0.4,1-1,1H2V1.5 M25,2.5
                c0-0.6,0.4-1,1-1h19v33H26c-0.6,0-1-0.4-1-1V2.5 M1,0.5v35h20c1.1,0,2-0.9,2-2v-31c0-1.1-0.9-2-2-2H1L1,0.5z M24,2.5v31
                c0,1.1,0.9,2,2,2h20v-35H26C24.9,0.5,24,1.4,24,2.5L24,2.5z" />

                    <linearGradient id="fGrad5" gradientUnits="userSpaceOnUse" x1="245.0833" y1="-1061.0476"
                        x2="245.0833" y2="-1058.0729"
                        gradientTransform="matrix(6.123234e-17 -1 -1 -6.123234e-17 -1034.0834 263.0833)">
                        <stop offset="0" style="stop-color:#FFFFFF;stop-opacity:0" />
                        <stop offset="0.5" style="stop-color:#FFFFFF" />
                    </linearGradient>
                    <path opacity="0.33" fill="url(#fGrad5)" d="M26,35.5h1v-1h-1c-0.6,0-1-0.4-1-1v-31c0-0.6,0.4-1,1-1
                h1v-1h-1c-1,0-1.8,0.7-2,1.6v31.8C24.2,34.8,25,35.5,26,35.5z" />
                </g>
            </svg>
        </element>

        <element id=trackSendSvg>
            <svg version="1.1" display="block" xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%"
                viewBox="0 0 320 48" xml:space="preserve">
                <rect class="sendPanelBg" fill="#333333" width="320" height="49" />
                <path class="sendBg" fill="#262626" d="M244,0c-0.3,0-0.7,0-1,0v0H142h-17H27v0c-0.3,0-0.7,0-1,0C13.8,0,4,9.8,4,22s9.8,22,22,22
            c0.3,0,0.7,0,1,0v0h98h17h101v0c0.3,0,0.7,0,1,0c12.2,0,22-9.8,22-22S256.2,0,244,0z" />
                <line class="sendLine" style="pointer-events:none" fill="none" opacity="0.5" stroke="#404040"
                    stroke-width="38" stroke-linecap="round" stroke-miterlimit="10" x1="27" y1="22" x2="130" y2="22" />
                <text class="sendTitleText" style="pointer-events:none" transform="matrix(1 0 0 1 25 29)" fill="#A3A3A3"
                    font-family="'Open Sans'" font-size="19px">Target Name</text>
                <text class="sDbText" style="pointer-events:none" text-anchor="end" transform="matrix(1 0 0 1 250 27)"
                    fill="#A3A3A3" font-family="'Open Sans'" font-size="12px">xx dB</text>
                <circle class="sendThumb" opacity="0.5" fill="#808080" stroke="#262626" stroke-width="2"
                    stroke-miterlimit="10" cx="26" cy="22" r="19" />

                <g class="send_mute button">
                    <g class="send_mute_off" visibility="visible">
                        <path class="shadow" opacity="0.15" d="M314.4,45.2c0,1-0.8,1.8-1.8,1.8h-39c-1,0-1.8-0.8-1.8-1.8
                        v-4.6h42.7v4.6H314.4z" />
                        <linearGradient id="smoGrad" gradientUnits="userSpaceOnUse" x1="1720.0585" y1="-785.3847"
                            x2="1720.0585" y2="-828.6583" gradientTransform="matrix(1 0 0 -1 -1427 -785)">
                            <stop offset="0" style="stop-color:#404040" />
                            <stop offset="1" style="stop-color:#333333" />
                        </linearGradient>
                        <path fill="url(#smoGrad)" d="M273.6,43.6c-1.2,0-2.1-1-2.1-2.1v-39c0-1.2,1-2.1,2.1-2.1h39c1.2,0,2.1,1,2.1,2.1v39
                        c0,1.2-1,2.1-2.1,2.1H273.6z" />
                        <g>
                            <path fill="#805240" d="M293.1,25.9L293.1,25.9l4.2-10h2.2v12.3h-1.8V19h-0.1l-3.9,9.1h-1.2l-4-9.5h-0.1v9.5h-1.8V15.9h2.3
                            L293.1,25.9z" />
                        </g>
                        <path class="mouseover" visibility="hidden" opacity="0.05" fill="#FFFFFF"
                            d="M273.6,43.6c-1.2,0-2.1-1-2.1-2.1v-39 c0-1.2,1-2.1,2.1-2.1h39c1.2,0,2.1,1,2.1,2.1v39c0,1.2-1,2.1-2.1,2.1H273.6z" />
                    </g>
                    <g class="send_mute_on" visibility="hidden">
                        <path display="inline" fill="#F13F24" d="M273.6,43.6c-1.2,0-2.1-1-2.1-2.1v-39c0-1.2,1-2.1,2.1-2.1h39c1.2,0,2.1,1,2.1,2.1v39
                        c0,1.2-1,2.1-2.1,2.1H273.6z" />
                        <g display="inline">
                            <path fill="#FFFFFF" d="M293.1,25.9L293.1,25.9l4.2-10h2.2v12.3h-1.8V19h-0.1l-3.9,9.1h-1.2l-4-9.5h-0.1v9.5h-1.8V15.9h2.3
                            L293.1,25.9z" />
                        </g>
                        <path class="mouseover" visibility="hidden" opacity="0" fill="#FFFFFF"
                            d="M273.6,43.6 c-1.2,0-2.1-1-2.1-2.1v-39c0-1.2,1-2.1,2.1-2.1h39c1.2,0,2.1,1,2.1,2.1v39c0,1.2-1,2.1-2.1,2.1H273.6z" />
                    </g>
                    <path fill="#1A1A1A" d="M312.6,0.7c1,0,1.8,0.8,1.8,1.8v39c0,1-0.8,1.8-1.8,1.8h-39c-1,0-1.8-0.8-1.8-1.8v-39
                    c0-1,0.8-1.8,1.8-1.8H312.6 M312.6,0.1h-39c-1.3,0-2.4,1.1-2.4,2.4v39c0,1.3,1.1,2.4,2.4,2.4h39c1.3,0,2.4-1.1,2.4-2.4v-39
                    C315,1.2,313.9,0.1,312.6,0.1L312.6,0.1z" />
                </g>
            </svg>
        </element>
        <element id=button>
            <button class="track_button"
                style="width:33.3%;height:90px;font-size:xx-large;background-color:gray;float:left;" value=0 hidden
                disabled>button</button>
        </element>
        <element id=last></element>
    </div>

</body>

</html>


<!--TO DO : change colours when colours change to default -->